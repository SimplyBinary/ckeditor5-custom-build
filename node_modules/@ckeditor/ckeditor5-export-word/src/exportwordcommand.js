/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x29c05f}from'ckeditor5/src/core';import{getStyles as _0x3f6a2e,getConverterOptions as _0x555510}from'./utils';export default class i extends _0x29c05f{constructor(_0x45625c){super(_0x45625c),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x20fc8d={}){const _0x1d8121=this['editor'],t=_0x1d8121['t'],_0x2029ed=_0x20fc8d['converterUrl']||'https://docx-converter.cke-cs.com/v1/convert',_0x5841ab=_0x20fc8d['converterOptions']||{},_0x6cbee=_0x1d8121['plugins']['get']('ExportWord'),_0x1efa78=_0x20fc8d['token']||_0x6cbee['_token'],_0x46c1bc=!0x1!==_0x5841ab['auto_pagination'],_0x229b95=_0x20fc8d['dataCallback']||(_0x8f0bea=>_0x8f0bea['getData']({'pagination':_0x46c1bc}));return this['isBusy']=!0x0,this['refresh'](),_0x3f6a2e(_0x20fc8d['stylesheets']||['EDITOR_STYLES'])['then'](_0x5d023f=>{const _0x3449d5=_0x229b95(_0x1d8121),_0x3d4faa={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x1d8121['locale']['contentLanguageDirection']+'\x22>'+_0x3449d5+'</div>','css':_0x5d023f,'options':{..._0x5841ab,..._0x555510(_0x1d8121)}},_0x3ebcac={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x1efa78?{'Authorization':_0x1efa78['value']}:null},'body':JSON['stringify'](_0x3d4faa)};return window['fetch'](_0x2029ed,_0x3ebcac)['then'](_0x23a2eb=>{if(0xc8!==_0x23a2eb['status'])throw _0x23a2eb;return _0x23a2eb['blob']();})['then'](_0x59b2a7=>{this['o'](_0x59b2a7,_0x20fc8d['fileName']||'document.docx');});})['catch'](_0x25f85f=>{throw _0x1d8121['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x25f85f;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x4aaa90,_0x5e01c0){const _0x31051a=document['createElement']('a');_0x31051a['href']=window['URL']['createObjectURL'](_0x4aaa90),_0x31051a['download']=_0x5e01c0,_0x31051a['click'](),_0x31051a['remove']();}}