!function(e){const t=e.en=e.en||{};t.dictionary=Object.assign(t.dictionary||{},{"An error occurred while generating the Word file.":"An error occurred while generating the Word file.","Export to Word":"Export to Word"})}(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={})),
/*!
 * @license Copyright (c) 2003-2022, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */(()=>{var e={345:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(758),o=n.n(r)()((function(e){return e[1]}));o.push([e.id,":root{--ck-toolbar-spinner-size:18px}.ck-exportword_status-pending{position:relative}.ck.ck-exportword__spinner-container{display:none}.ck.ck-exportword__spinner{border:2px solid var(--ck-color-text);border-radius:50%;border-top:2px solid transparent;height:var(--ck-toolbar-spinner-size);left:0;margin:0 auto;position:absolute;right:0;top:50%;transform:translateY(-50%);width:var(--ck-toolbar-spinner-size);z-index:1}.ck-exportword_status-pending .ck.ck-exportword__spinner-container{animation:rotate 1.5s linear infinite;display:block;height:var(--ck-toolbar-spinner-size);position:absolute;width:var(--ck-toolbar-spinner-size)}.ck-exportword_status-pending .ck.ck-button__icon{color:transparent}@keyframes rotate{to{transform:rotate(1turn)}}",""]);const i=o},758:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(r)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(o[s]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);r&&o[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},278:(e,t,n)=>{"use strict";var r,o=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function a(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},r=[],o=0;o<e.length;o++){var i=e[o],c=t.base?i[0]+t.base:i[0],d=n[c]||0,u="".concat(c," ").concat(d);n[c]=d+1;var l=a(u),p={css:i[1],media:i[2],sourceMap:i[3]};-1!==l?(s[l].references++,s[l].updater(p)):s.push({identifier:u,updater:v(p,t),references:1}),r.push(u)}return r}function d(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var s=i(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var u,l=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function p(e,t,n,r){var o=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=l(t,o);else{var i=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function f(e,t,n){var r=n.css,o=n.media,i=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var h=null,x=0;function v(e,t){var n,r,o;if(t.singleton){var i=x++;n=h||(h=d(t)),r=p.bind(null,n,i,!1),o=p.bind(null,n,i,!0)}else n=d(t),r=f.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=o());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var o=a(n[r]);s[o].references--}for(var i=c(e,t),d=0;d<n.length;d++){var u=a(n[d]);0===s[u].references&&(s[u].updater(),s.splice(u,1))}n=i}}}},704:(e,t,n)=>{e.exports=n(79)("./src/core.js")},273:(e,t,n)=>{e.exports=n(79)("./src/ui.js")},79:e=>{"use strict";e.exports=CKEditor5.dll}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{ExportWord:()=>x});var e=n(704),t=n(273);const o=["Users","DateTimeFormat","suggestions","keys","all","createdAt","then","comments","author","fetch","content","timeZone","CommentsRepository","map","join","styleSheets","The editor stylesheet could not be found in the document. Check your webpack config â€“ style-loader should use data-cke=true attribute for the editor stylesheet.","timezone","warn","push","cssText","data-cke","getSuggestions","get","resolvedOptions","indexOf","TrackChanges","text",".ck-content","trim","name","authorId","length","ownerNode","plugins","cssRules","has","hasAttribute"];var i,s;i=o,s=374,function(e){for(;--e;)i.push(i.shift())}(++s);const a=function(e,t){return o[e-=0]};function c(){const e=[],t=[];for(const n of document[a("0x15")])if(n[a("0x1")][a("0x5")](a("0x1b")))for(const r of n[a("0x3")])-1!==r[a("0x1a")][a("0x1f")](a("0x22"))?e[a("0x19")](r[a("0x1a")]):-1!==r[a("0x1a")].indexOf(":root")&&t.push(r.cssText);return e[a("0x0")]||console[a("0x18")](a("0x16")),[...t,...e][a("0x14")](" ")[a("0x23")]()}function d(e){const t=e[a("0x2")].has(a("0x6")),n=e[a("0x2")][a("0x4")](a("0x12")),r=e.plugins.has(a("0x20")),o={};if(t&&n){const t=function(e){const t={};if(!e[a("0x0")])return t;for(const n of e)n[a("0xd")][a("0x13")]((e=>{void 0===t[n.id]&&(t[n.id]=[]),t[n.id].push({author:e[a("0xe")][a("0x24")],content:e[a("0x10")],created:e[a("0xb")]})}));return t}(e[a("0x2")][a("0x1d")](a("0x12")).getCommentThreads({skipNotAttached:!0,skipEmpty:!0}));Object[a("0x9")](t)[a("0x0")]&&(o[a("0xd")]=t)}if(t&&r){const t=e[a("0x2")].get(a("0x20")),n=e[a("0x2")][a("0x1d")]("Users"),r=function(e,t){const n={};if(!e[a("0x0")]||!t[a("0x0")])return n;for(const r of e)n[r.id]={author:t[a("0x1d")](r[a("0x25")])[a("0x24")],created:r[a("0xb")]};return n}(t[a("0x1c")]({toJSON:!0}),n.users);Object[a("0x9")](r)[a("0x0")]&&(o[a("0x8")]=r)}return(o[a("0x8")]||o[a("0xd")])&&(o[a("0x17")]=(new(Intl[a("0x7")]))[a("0x1e")]()[a("0x11")]),o}class u extends e.Command{constructor(e){super(e),this.set("isBusy",!1),this.affectsData=!1}refresh(){this.isEnabled=!this.isBusy,this.value=this.isBusy?"pending":void 0}execute(e={}){const t=this.editor,n=t.t,r=e.converterUrl||"https://docx-converter.cke-cs.com/v1/convert",o=e.converterOptions||{},i=t.plugins.get("ExportWord"),s=e.token||i._token,u=!1!==o.auto_pagination,l=e.dataCallback||(e=>e.getData({pagination:u}));return this.isBusy=!0,this.refresh(),function(e){if(!e)return new Promise((e=>e("")));const t=[];for(const n of e)"EDITOR_STYLES"!==n?t[a("0x19")](window[a("0xf")](n)[a("0xc")]((e=>e[a("0x21")]()))):t[a("0x19")](c());return Promise[a("0xa")](t)[a("0xc")]((e=>e[a("0x14")](" ").trim()))}(e.stylesheets||["EDITOR_STYLES"]).then((n=>{const i=l(t),a={html:'<div class="ck-content" dir="'+t.locale.contentLanguageDirection+'">'+i+"</div>",css:n,options:{...o,...d(t)}},c={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/docx",...s?{Authorization:s.value}:null},body:JSON.stringify(a)};return window.fetch(r,c).then((e=>{if(200!==e.status)throw e;return e.blob()})).then((t=>{this.o(t,e.fileName||"document.docx")}))})).catch((e=>{throw t.plugins.get("Notification").showWarning(n("An error occurred while generating the Word file.")),e})).finally((()=>{this.isBusy=!1,this.refresh()}))}o(e,t){const n=document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,n.click(),n.remove()}}var l=n(278),p=n.n(l),f=n(345),h={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};p()(f.Z,h);f.Z.locals;class x extends e.Plugin{static get pluginName(){return"ExportWord"}static get requires(){return["CloudServices",t.Notification]}init(){const e=this.editor,n=e.t,r=e.config.get("exportWord")||{};e.commands.add("exportWord",new u(e)),e.ui.componentFactory.add("exportWord",(o=>{const i=e.commands.get("exportWord"),s=new t.ButtonView(o);s.set({label:n("Export to Word"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14 0 5 4.5V20H3v-1.5h14.5v-12h-5v-5h-8v4H3V0h11ZM8.5 7a1.5 1.5 0 0 1 1.493 1.356L10 8.5v7a1.5 1.5 0 0 1-1.356 1.493L8.5 17h-7a1.5 1.5 0 0 1-1.493-1.356L0 15.5v-7a1.5 1.5 0 0 1 1.356-1.493L1.5 7h7ZM7.483 9.795l-.042.088-.986 2.534-.947-2.528-.043-.092a.601.601 0 0 0-1.042.008l-.042.093-.883 2.465-.937-2.475-.042-.089a.6.6 0 0 0-1.107.42l.027.093 1.514 4 .044.092a.601.601 0 0 0 1.041-.01l.041-.092.88-2.458.925 2.467.046.096a.601.601 0 0 0 1.032 0l.043-.09 1.554-4 .028-.093a.6.6 0 0 0-1.104-.43ZM14 2v3h3.3L14 2Z"/></svg>\n',tooltip:!0}),s.bind("isOn","isEnabled").to(i,"isBusy","isEnabled"),s.extendTemplate({attributes:{class:[s.bindTemplate.if("isOn","ck-exportword_status-pending")]}});const a=new t.View;return a.setTemplate({tag:"span",attributes:{class:["ck","ck-exportword__spinner-container"]},children:[{tag:"span",attributes:{class:["ck","ck-exportword__spinner"]}}]}),s.children.add(a),this.listenTo(s,"execute",(()=>{e.execute("exportWord",r),e.editing.view.focus()})),s}));const o=e.plugins.get("CloudServices");if(!1===r.tokenUrl)this._token=null;else{if(r.tokenUrl)return o.registerTokenUrl(r.tokenUrl).then((e=>{this._token=e}));this._token=o.token}}}})(),(window.CKEditor5=window.CKEditor5||{}).exportWord=r})();