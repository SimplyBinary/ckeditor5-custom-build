/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x1625=['remove','commands','execute','trackChanges','PendingActions','view','suggestionUnloaded','values','value','getAllAdjacentSuggestions','has','discardAllSuggestions','buttonView','trackChanges.SuggestionThreadView','switchbutton','type','comments.maxCommentCharsWhenCollapsed','CommentsUI','from','delete','define','commandName','source','unbind','actionView','filter','focus','cancel','listenTo','getMarkerNames','get','change:activeAnnotations','activeMarkers','innerView','change:previous','getJoined','_descriptionFactory','TrackChangesEditing','keys','locale','isOn','getDescriptions','discardSelectedSuggestions','_disableComments','_destroyController','separator','length','refreshSelectedViews','clear','destroy','model','Track\x20changes','bind','plugins','push','some','Annotations','comments.maxCommentsWhenCollapsed','getFirstMarker','head','_debouncedHandlers','descriptionParts','Accept\x20all\x20suggestions','isEnabled','isMultiRange','isDirty','getRanges','suggestion-','getContainedElement','getRange','arrowView','config','EditorAnnotations','SuggestionThreadView','set','getSuggestion','pluginName','CommentsRepository','_suggestionToController','editing','add','trackChanges.disableComments','editor','comments.editorConfig','init','button','toMany','stopListening','previous','commentThread','acceptSelectedSuggestions','addSourceCollector','_viewToController','_createUIButton','map','PENDING_ACTION_SUGGESTION','getFirstRange','getByInnerView','_initializeController','_updateController','createAnnotationView','requires','reduce','toViewElement','Discard\x20all\x20selected\x20suggestions','isInContent','discardSuggestion','comments'];(function(_0x1ad1ea,_0x162572){const _0x417dcf=function(_0x2b8930){while(--_0x2b8930){_0x1ad1ea['push'](_0x1ad1ea['shift']());}};_0x417dcf(++_0x162572);}(_0x1625,0xd4));const _0x417d=function(_0x1ad1ea,_0x162572){_0x1ad1ea=_0x1ad1ea-0x0;let _0x417dcf=_0x1625[_0x1ad1ea];return _0x417dcf;};import{Plugin as _0x4d458a}from'ckeditor5/src/core';import{Collection as _0x2840d4}from'ckeditor5/src/utils';import{Model as _0x284193,SplitButtonView as _0x432863,createDropdown as _0x315563,addListToDropdown as _0x1976bc}from'ckeditor5/src/ui';import{Users as _0x40a97a,getDateTimeFormatter as _0x3c583d,getMarkerDomElement as _0x5af7e0}from'ckeditor5-collaboration/src/collaboration-core';import{debounce as _0x2624f1}from'lodash-es';import _0x52d57c from'./trackchangesediting';import _0x50e52b from'./ui/suggestioncontroller';import _0x46029d from'./ui/view/suggestionthreadview';import{getTranslation as _0x32166e}from'./utils/common-translations';import _0x196f67 from'../theme/icons/track-changes.svg';export default class m extends _0x4d458a{static get[_0x417d('0x69')](){return[_0x52d57c,_0x40a97a,_0x417d('0x51'),_0x417d('0x3c'),_0x417d('0x4c')];}static get[_0x417d('0x50')](){return'TrackChangesUI';}constructor(_0x21e426){super(_0x21e426),this['_suggestionToController']=new Map(),this[_0x417d('0x60')]=new Map(),this[_0x417d('0x40')]=new Map();const _0x761910=this[_0x417d('0x56')][_0x417d('0x4b')];_0x761910[_0x417d('0x18')](_0x417d('0x11'),_0x46029d),_0x761910['define'](_0x417d('0x55'),!0x1),this['_disableComments']=_0x761910['get']('trackChanges.disableComments');}[_0x417d('0x58')](){const _0x3a60ee=this['editor'],_0x4ed02b=_0x3a60ee[_0x417d('0x39')][_0x417d('0x22')](_0x52d57c),_0x32dfeb=_0x3a60ee[_0x417d('0x39')][_0x417d('0x22')](_0x417d('0x3c')),_0xba56f9=_0x3a60ee[_0x417d('0x39')]['get'](_0x417d('0x4c')),_0x2acf77=_0x3a60ee[_0x417d('0x39')]['get'](_0x417d('0x51'));_0x3a60ee['ui']['componentFactory'][_0x417d('0x54')](_0x417d('0x7'),_0x27f5c4=>this['_createUIButton'](_0x27f5c4)),_0xba56f9[_0x417d('0x5f')](()=>{const _0x22ec11=[];for(const [_0x32fa6f,_0x1c0631]of Array[_0x417d('0x16')](this[_0x417d('0x52')])){const _0xe1ee07=_0x32fa6f[_0x417d('0xd')](),_0x55bceb=[];for(const _0x3212d1 of _0xe1ee07){if(!_0x3212d1['isInContent'])continue;if(_0x3212d1[_0x417d('0x44')]){_0x55bceb[_0x417d('0x3a')](..._0x3212d1[_0x417d('0x46')]());continue;}const _0x1255f3=_0x3212d1[_0x417d('0x64')]();if(_0x55bceb[_0x417d('0x32')]>0x0){const _0x49c6ad=_0x55bceb[0x0][_0x417d('0x27')](_0x1255f3);if(_0x49c6ad){_0x55bceb[0x0]=_0x49c6ad;continue;}}_0x55bceb[_0x417d('0x3a')](_0x1255f3);}_0x22ec11[_0x417d('0x3a')]([_0x1c0631[_0x417d('0x9')],_0x55bceb]);}return _0x22ec11;}),this[_0x417d('0x20')](_0x4ed02b,'suggestionLoaded',(_0x4adb60,_0x2b21d5)=>{let _0x2dda3d=!0x1;const _0x18c9bb=_0x2624f1(_0x4859cf=>{_0x2dda3d||_0x4859cf?_0x2dda3d&&_0x4859cf&&(this[_0x417d('0x30')](_0x2b21d5),_0xba56f9[_0x417d('0x33')](),_0x2dda3d=!0x1):(this[_0x417d('0x66')](_0x2b21d5),_0xba56f9[_0x417d('0x33')](),_0x2dda3d=!0x0);},0xa);this[_0x417d('0x40')][_0x417d('0x4e')](_0x2b21d5,_0x18c9bb),this['listenTo'](_0x2b21d5,_0x417d('0x26'),(_0x595a09,_0x3ddc33,_0xce2ac4,_0x2d2b50)=>{_0x2b21d5[_0x417d('0x1')]&&(null==_0xce2ac4?(this[_0x417d('0x67')](_0x2d2b50[_0x417d('0x3f')]),_0x18c9bb(!0x1)):(this[_0x417d('0x67')](_0xce2ac4[_0x417d('0x3f')]),_0x18c9bb(!0x0)));}),null===_0x2b21d5[_0x417d('0x5c')]?_0x18c9bb(!0x1):this[_0x417d('0x67')](_0x2b21d5[_0x417d('0x3f')]);}),this[_0x417d('0x20')](_0x4ed02b,_0x417d('0xa'),(_0x5d1546,_0x2c9316,_0x27acbc)=>{this[_0x417d('0x5b')](_0x2c9316,_0x417d('0x26')),this['_debouncedHandlers']['get'](_0x2c9316)[_0x417d('0x1f')](),this[_0x417d('0x40')][_0x417d('0x17')](_0x2c9316);const _0x11f23b=_0x27acbc?_0x27acbc[_0x417d('0x3f')]:_0x2c9316,_0x4e175f=this[_0x417d('0x52')][_0x417d('0x22')](_0x11f23b);null!==_0x27acbc&&this[_0x417d('0x67')](_0x11f23b),null===_0x27acbc&&_0x4e175f&&this['_destroyController'](_0x2c9316);}),this[_0x417d('0x20')](_0x4ed02b,'suggestionChanged',(_0x1c4f6e,_0x5a7428)=>{this[_0x417d('0x67')](_0x5a7428);}),this[_0x417d('0x20')](_0x32dfeb,_0x417d('0x23'),(_0x35cf49,_0xbebe75,_0x3d55d0)=>{const _0x436939=Array[_0x417d('0x16')](_0x3d55d0,_0x40b4d3=>_0x40b4d3[_0x417d('0x25')])[_0x417d('0x1d')](_0x541197=>this[_0x417d('0x60')][_0x417d('0xe')](_0x541197)),_0x442bfa=[];for(const _0xc82691 of _0x436939){const _0x39bb39=this[_0x417d('0x60')][_0x417d('0x22')](_0xc82691)[_0x417d('0x36')][_0x417d('0xd')]();_0x442bfa['push'](..._0x39bb39[_0x417d('0x6a')]((_0xab00f1,_0x69c40d)=>[..._0xab00f1,..._0x69c40d[_0x417d('0x21')]()],[]));}_0x4ed02b[_0x417d('0x24')]=_0x442bfa;}),this[_0x417d('0x20')](_0x2acf77,'addComment',(_0x31ad55,{threadId:_0x1abd7b,isFromAdapter:_0x1ae6f2})=>{if(_0x1ae6f2||!_0x4ed02b['hasSuggestion'](_0x1abd7b))return;const _0x3fde5f=_0x4ed02b[_0x417d('0x4f')](_0x1abd7b);this[_0x417d('0x52')][_0x417d('0x22')](_0x3fde5f)['view'][_0x417d('0x1e')]();},{'priority':'lowest'});}[_0x417d('0x61')](_0x1dfbab){const _0x55e494=_0x315563(_0x1dfbab,_0x432863),_0x4f52ae=this[_0x417d('0x56')]['commands'][_0x417d('0x22')]('trackChanges'),_0x14d4d9=_0x32166e(_0x1dfbab,_0x417d('0x37'));_0x55e494[_0x417d('0x10')][_0x417d('0x4e')]({'tooltip':_0x14d4d9,'label':_0x14d4d9,'icon':_0x196f67}),_0x55e494[_0x417d('0x10')][_0x417d('0x38')]('isOn')['to'](_0x4f52ae,_0x417d('0xc')),_0x55e494[_0x417d('0x10')]['on']('execute',()=>_0x4f52ae[_0x417d('0x6')]());const _0x16daa4=new _0x2840d4(),_0x200f54=[{'type':_0x417d('0x12'),'model':{'withText':!0x0,'label':_0x14d4d9,'commandName':'trackChanges'}},{'type':_0x417d('0x31')},{'type':_0x417d('0x59'),'model':{'withText':!0x0,'label':_0x32166e(_0x1dfbab,_0x417d('0x42')),'commandName':'acceptAllSuggestions'}},{'type':_0x417d('0x59'),'model':{'withText':!0x0,'label':_0x32166e(_0x1dfbab,'Accept\x20all\x20selected\x20suggestions'),'commandName':_0x417d('0x5e')}},{'type':_0x417d('0x59'),'model':{'withText':!0x0,'label':_0x32166e(_0x1dfbab,'Discard\x20all\x20suggestions'),'commandName':_0x417d('0xf')}},{'type':'button','model':{'withText':!0x0,'label':_0x32166e(_0x1dfbab,_0x417d('0x0')),'commandName':_0x417d('0x2e')}}];for(const _0x2e4dcd of _0x200f54){const _0x1a72b9={'type':_0x2e4dcd[_0x417d('0x13')]};if(_0x2e4dcd[_0x417d('0x36')]){const _0x4098bd=new _0x284193(_0x2e4dcd['model']),_0x4ab166=this[_0x417d('0x56')][_0x417d('0x5')][_0x417d('0x22')](_0x4098bd[_0x417d('0x19')]);_0x4098bd['bind'](_0x417d('0x2c'),'isEnabled')['to'](_0x4ab166,_0x417d('0xc'),_0x417d('0x43')),_0x1a72b9['model']=_0x4098bd;}_0x16daa4['add'](_0x1a72b9);}_0x1976bc(_0x55e494,_0x16daa4);const _0x5e4e6f=_0x200f54[_0x417d('0x1d')](_0x46a3a8=>null!=_0x46a3a8[_0x417d('0x36')])[_0x417d('0x62')](_0x59dd3c=>this[_0x417d('0x56')][_0x417d('0x5')][_0x417d('0x22')](_0x59dd3c[_0x417d('0x36')][_0x417d('0x19')]));return _0x55e494[_0x417d('0x10')]['actionView'][_0x417d('0x1b')](_0x417d('0x43')),_0x55e494[_0x417d('0x10')][_0x417d('0x4a')][_0x417d('0x1b')](_0x417d('0x43')),_0x55e494[_0x417d('0x10')][_0x417d('0x1c')][_0x417d('0x38')](_0x417d('0x43'))['to'](_0x4f52ae,_0x417d('0x43')),_0x55e494[_0x417d('0x10')][_0x417d('0x4a')][_0x417d('0x38')](_0x417d('0x43'))[_0x417d('0x5a')](_0x5e4e6f,_0x417d('0x43'),(..._0x982d3a)=>_0x982d3a[_0x417d('0x3b')](_0x4fb4ea=>_0x4fb4ea)),_0x55e494['on'](_0x417d('0x6'),_0x364222=>this['editor']['execute'](_0x364222[_0x417d('0x1a')][_0x417d('0x19')])),_0x55e494;}[_0x417d('0x66')](_0x4ccd5f){const _0x4bd0c6=this[_0x417d('0x56')],_0x125137=_0x4bd0c6[_0x417d('0x4b')],_0x5b1e9f=_0x4bd0c6[_0x417d('0x39')][_0x417d('0x22')]('Annotations'),_0xb600e4=_0x4bd0c6[_0x417d('0x39')][_0x417d('0x22')](_0x417d('0x51')),_0x799c6c=_0x4ccd5f[_0x417d('0xd')]()[_0x417d('0x1d')](_0x148ed1=>_0x148ed1[_0x417d('0x1')]),_0xd9c777=_0x4bd0c6[_0x417d('0x39')][_0x417d('0x22')](_0x40a97a)['me'],_0x1371b6=_0x4bd0c6[_0x417d('0x5')]['get']('acceptSuggestion'),_0x32eb31=_0x4bd0c6['commands']['get'](_0x417d('0x2')),_0x264836=_0x125137[_0x417d('0x22')](_0x417d('0x7'))[_0x417d('0x4d')],{CommentsListView:_0x4d1d8f,CommentThreadInputView:_0x450141}=_0x4bd0c6[_0x417d('0x39')]['get'](_0x417d('0x15')),_0x592953=new _0x264836(_0x4bd0c6[_0x417d('0x2b')],_0x4ccd5f,_0xd9c777,{'disableComments':this[_0x417d('0x2f')],'editorConfig':_0x125137[_0x417d('0x22')](_0x417d('0x57')),'maxCommentsWhenCollapsed':_0x125137['get'](_0x417d('0x3d')),'maxThreadTotalWeight':_0x125137[_0x417d('0x22')]('comments.maxThreadTotalWeight'),'maxCommentCharsWhenCollapsed':_0x125137[_0x417d('0x22')](_0x417d('0x14')),'formatDateTime':_0x3c583d(_0x125137[_0x417d('0x22')](_0x417d('0x2b'))),'CommentView':_0x125137['get'](_0x417d('0x3'))['CommentView'],'CommentsListView':_0x4d1d8f,'CommentThreadInputView':_0x450141}),_0x5d0307=_0xb600e4['createCommentThreadController'](_0x4ccd5f[_0x417d('0x5d')],_0x592953),_0x5b5daa=new _0x50e52b(_0x4ccd5f,_0x592953,_0x1371b6,_0x32eb31,_0x5d0307);_0x592953[_0x417d('0x41')]=_0x4bd0c6['plugins'][_0x417d('0x22')](_0x417d('0x29'))[_0x417d('0x28')][_0x417d('0x2d')](_0x799c6c),this[_0x417d('0x52')][_0x417d('0x4e')](_0x4ccd5f,_0x5b5daa),this[_0x417d('0x60')]['set'](_0x592953,_0x5b5daa);const _0x4f7891=_0x5b1e9f[_0x417d('0x68')](this[_0x417d('0x56')][_0x417d('0x2b')],_0x592953);_0x4f7891[_0x417d('0x38')](_0x417d('0x45'))['to'](_0x592953,_0x417d('0x45')),_0x4f7891[_0x417d('0x38')](_0x417d('0x32'))['to'](_0x592953),_0x4f7891['bind'](_0x417d('0x13'))['to'](_0x592953,_0x417d('0x13'),_0x8caaca=>_0x417d('0x47')+_0x8caaca);const _0x2978fa=_0x5b1e9f['createAnnotation']({'view':_0x4f7891,'target':()=>{const _0x3adef9=_0x799c6c[0x0][_0x417d('0x3e')]();if(!_0x3adef9)return null;const _0x4d25c7=_0x3adef9[_0x417d('0x49')]()[_0x417d('0x48')]();return _0x4d25c7&&!_0x4bd0c6[_0x417d('0x53')]['mapper'][_0x417d('0x6b')](_0x4d25c7)?null:_0x5af7e0(_0x4bd0c6[_0x417d('0x53')],_0x3adef9)||null;},'type':()=>_0x417d('0x47')+_0x5b5daa[_0x417d('0x9')][_0x417d('0x13')]});_0x5b1e9f[_0x417d('0x54')](_0x2978fa);const _0x79b56a=_0x4bd0c6[_0x417d('0x39')][_0x417d('0x22')](_0x417d('0x8'));let _0x5b54cf;_0x592953['on']('change:isDirty',(_0x26dcf3,_0x2387d9,_0x124381)=>{_0x124381?_0x5b54cf=_0x79b56a['add'](_0x32166e(this[_0x417d('0x56')][_0x417d('0x2b')],_0x417d('0x63'))):(_0x79b56a[_0x417d('0x4')](_0x5b54cf),_0x5b54cf=null);});}[_0x417d('0x30')](_0x3341fd){const _0x1fe397=this[_0x417d('0x56')][_0x417d('0x39')][_0x417d('0x22')]('Annotations'),_0x2ca666=this[_0x417d('0x52')]['get'](_0x3341fd),_0x2704a2=_0x2ca666['view'],_0x532165=_0x1fe397[_0x417d('0x65')](_0x2704a2);_0x532165&&_0x1fe397[_0x417d('0x4')](_0x532165),this[_0x417d('0x52')][_0x417d('0x17')](_0x3341fd),this[_0x417d('0x60')][_0x417d('0x17')](_0x2704a2),_0x2ca666['destroy'](),_0x2704a2[_0x417d('0x35')]();}['_updateController'](_0x1b84a6){if(!_0x1b84a6[_0x417d('0x1')]||!this[_0x417d('0x52')][_0x417d('0xe')](_0x1b84a6))return;const _0x56af9b=this[_0x417d('0x56')][_0x417d('0x39')][_0x417d('0x22')](_0x417d('0x29')),_0x43e94e=this['_suggestionToController']['get'](_0x1b84a6),_0x39cb03=_0x1b84a6[_0x417d('0xd')]();_0x43e94e[_0x417d('0x9')][_0x417d('0x41')]=_0x56af9b[_0x417d('0x28')]['getDescriptions'](_0x39cb03);}['destroy'](){super['destroy']();for(const _0x4c4e65 of this[_0x417d('0x52')][_0x417d('0x2a')]())this[_0x417d('0x30')](_0x4c4e65);for(const _0x4e9ad5 of this['_debouncedHandlers'][_0x417d('0xb')]())_0x4e9ad5[_0x417d('0x1f')]();this[_0x417d('0x40')][_0x417d('0x34')]();}}