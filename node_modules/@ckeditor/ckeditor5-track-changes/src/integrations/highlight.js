/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Plugin as _0x445cd4}from'ckeditor5/src/core';import{getRangesWithAttribute as Rt}from'./utils';export default class H extends _0x445cd4{['afterInit'](){const _0x23a06d=this['editor'];if(!_0x23a06d['plugins']['has']('HighlightEditing'))return;const _0xda63aa=_0x23a06d['plugins']['get']('TrackChangesEditing');_0xda63aa['enableCommand']('highlight',(_0x3be3f6,_0x45f48e={})=>{const _0x1fb076=_0x23a06d['model']['document']['selection'],_0x54c517=_0x1fb076['getAttribute']('highlight');let _0x1db34a=_0x45f48e['value'],_0x242d2c=[];if(_0x1fb076['isCollapsed']){const _0x5a1fae=_0x1fb076['getFirstPosition']();if(!_0x1fb076['hasAttribute']('highlight'))return void _0x3be3f6(_0x45f48e);{const _0x5971ab=_0x2cb28b=>_0x2cb28b['item']['getAttribute']('highlight')===_0x54c517,_0x44b6ff=_0x5a1fae['getLastMatchingPosition'](_0x5971ab,{'direction':'backward'}),_0xd5564=_0x5a1fae['getLastMatchingPosition'](_0x5971ab);_0x242d2c=[_0x23a06d['model']['createRange'](_0x44b6ff,_0xd5564)],_0x1db34a==_0x54c517&&(_0x1db34a=null);}}else for(const _0x3fd12c of _0x1fb076['getRanges']())_0x1db34a?_0x242d2c['push'](_0x3fd12c):_0x242d2c['push'](...Rt('highlight',_0x3fd12c,_0x23a06d['model']));_0x23a06d['model']['change'](()=>{for(const _0x57c7e7 of _0x242d2c)_0xda63aa['markInlineFormat'](_0x57c7e7,{'commandName':'highlight','commandParams':[{'value':_0x1db34a}]});});});const {t:t}=_0x23a06d['locale'];_0xda63aa['_descriptionFactory']['registerDescriptionCallback'](_0x3e8bee=>{const {type:_0x3db140,data:_0x27946a}=_0x3e8bee;if('formatInline'==_0x3db140&&_0x27946a&&'highlight'==_0x27946a['commandName']){const _0x5f42d5=_0x27946a['commandParams'][0x0]['value'];if(_0x5f42d5){const _0x2e9346=_0x23a06d['config']['get']('highlight.options')['find'](_0x5da34b=>_0x5da34b['model']==_0x5f42d5),_0x56f92b=_0x23a06d['locale']['_t'](_0x2e9346['title'])['toLowerCase']();return{'type':'format','content':t('*Set\x20highlight:*\x20%0',_0x56f92b),'color':{'value':_0x2e9346['color'],'title':_0x2e9346['title']}};}return{'type':'format','content':t('*Remove\x20highlight*',t({'string':'highlight','id':'FORMAT_HIGHLIGHT'}))};}});}}