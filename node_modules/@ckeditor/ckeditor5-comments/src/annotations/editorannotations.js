/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x5d02=['blur','model','init','element','isReadOnly','requires','refresh','_editorAnnotationsData','remove','range','selection','document','annotation','_dataCollectors','change:range','function','fire','listenTo','uiUpdate','update','isEqual','innerView','containsRange','getOrderedSelectedAnnotations','editing','add','getRanges','push','has','change:isFocused','addSourceCollector','view','focusTracker','get','collection','delete','getByInnerView','set','cancel','EditorAnnotations','editorannotations-invalid-source-callback','from','editor','hasDomSelection','refreshSelectedViews'];(function(_0x2d6d48,_0x5d02ef){const _0x703ba7=function(_0x402c49){while(--_0x402c49){_0x2d6d48['push'](_0x2d6d48['shift']());}};_0x703ba7(++_0x5d02ef);}(_0x5d02,0x122));const _0x703b=function(_0x2d6d48,_0x5d02ef){_0x2d6d48=_0x2d6d48-0x0;let _0x703ba7=_0x5d02[_0x2d6d48];return _0x703ba7;};import{Plugin as _0x1a1860}from'ckeditor5/src/core';import{CKEditorError as _0x38bc9a}from'ckeditor5/src/utils';import{debounce as _0x2bee78}from'lodash-es';import _0x1d7938 from'./annotations';export default class k extends _0x1a1860{static get[_0x703b('0x1e')](){return[_0x1d7938];}static get['pluginName'](){return _0x703b('0x13');}constructor(_0x8812db){super(_0x8812db),this['_dataCollectors']=new Set();}[_0x703b('0x1b')](){const _0xf5ec75=this[_0x703b('0x16')],_0x2ac575=_0xf5ec75['plugins'][_0x703b('0xd')](_0x1d7938),_0x2aab64=_0xf5ec75[_0x703b('0x1a')][_0x703b('0x24')][_0x703b('0x23')],_0x232d76=_0x2bee78(()=>this[_0x703b('0x18')](),0xa);_0x2aab64['on'](_0x703b('0x27'),(_0x29d245,_0x11a404)=>{_0x11a404['directChange']&&(_0x232d76[_0x703b('0x12')](),this[_0x703b('0x18')]());}),this[_0x703b('0x2a')](_0xf5ec75[_0x703b('0x4')][_0x703b('0xb')][_0x703b('0x24')],_0x703b('0x9'),(_0x5766a2,_0x46da9f,_0x956afa)=>{_0x956afa&&_0x232d76();}),this[_0x703b('0x2a')](_0xf5ec75['ui'][_0x703b('0xc')],_0x703b('0x9'),(_0x80a00,_0x1d40d5,_0x2dbb1c)=>{_0x2dbb1c||_0xf5ec75[_0x703b('0x1d')]||this['fire'](_0x703b('0x19'),{'isAnnotationTracked':_0x3931c0=>this[_0x703b('0x20')][_0x703b('0x8')](_0x3931c0['innerView'])});}),this[_0x703b('0x2a')](this[_0x703b('0x16')]['ui'],_0x703b('0x2c'),()=>this['fire'](_0x703b('0x2b')));const _0x2814e0=new Set();this[_0x703b('0x2a')](_0x2ac575[_0x703b('0xe')],_0x703b('0x5'),(_0x103755,_0x170573)=>{for(const _0x4a1b02 of this[_0x703b('0x20')]['keys']())if(_0x4a1b02===_0x170573[_0x703b('0x1')]){_0xf5ec75['ui']['focusTracker'][_0x703b('0x5')](_0x170573[_0x703b('0xb')][_0x703b('0x1c')]),_0x2814e0[_0x703b('0x5')](_0x170573['view']);break;}}),this[_0x703b('0x2a')](_0x2ac575['collection'],_0x703b('0x21'),(_0x332075,_0x33f688)=>{_0x2814e0[_0x703b('0x8')](_0x33f688[_0x703b('0xb')])&&(_0xf5ec75['ui'][_0x703b('0xc')]['remove'](_0x33f688[_0x703b('0xb')][_0x703b('0x1c')]),_0x2814e0[_0x703b('0xf')](_0x33f688[_0x703b('0xb')]));});}[_0x703b('0x17')](){return this[_0x703b('0x16')][_0x703b('0x4')][_0x703b('0xb')][_0x703b('0x17')];}[_0x703b('0xa')](_0x255b37){if(_0x703b('0x28')!=typeof _0x255b37)throw new _0x38bc9a(_0x703b('0x14'));this[_0x703b('0x26')][_0x703b('0x5')](_0x255b37);}[_0x703b('0x18')](){this[_0x703b('0x29')](_0x703b('0x1f'));}[_0x703b('0x3')]({activeAnnotation:_0x5066fd,annotations:_0x2ec0b0}){const _0x2ae3aa=[],_0x1b9ff2=this[_0x703b('0x16')][_0x703b('0x1a')][_0x703b('0x24')][_0x703b('0x23')],_0x30e1f4=Array['from'](_0x1b9ff2[_0x703b('0x6')]());for(const [_0x278464,_0x4adb68]of this[_0x703b('0x20')]){const _0x42a665=_0x2e9969(_0x4adb68),_0x395bd0=_0x2ec0b0[_0x703b('0x10')](_0x278464);_0x42a665&&_0x395bd0&&_0x2ae3aa[_0x703b('0x7')]({'annotation':_0x395bd0,'range':_0x42a665});}function _0x2e9969(_0x1d6629){for(const _0x5a1657 of _0x1d6629)for(const _0x41e178 of _0x30e1f4)if(_0x5a1657['containsRange'](_0x41e178,!_0x1b9ff2['isCollapsed']))return _0x5a1657;return null;}return _0x2ae3aa['sort']((_0x38b417,_0xf55f6a)=>{const _0x350387=_0x38b417[_0x703b('0x22')],_0x28bdce=_0xf55f6a['range'];if(!_0x350387[_0x703b('0x0')](_0x28bdce)){if(_0x350387[_0x703b('0x2')](_0x28bdce,!0x0))return 0x1;if(_0x28bdce[_0x703b('0x2')](_0x350387,!0x0))return-0x1;}return _0x38b417['annotation']==_0x5066fd?-0x1:_0xf55f6a[_0x703b('0x25')]==_0x5066fd?0x1:0x0;})['map'](_0x101b65=>_0x101b65[_0x703b('0x25')]);}get[_0x703b('0x20')](){const _0x1d1072=new Map();for(const _0x457536 of Array[_0x703b('0x15')](this[_0x703b('0x26')]))for(const [_0x2307e7,_0xa2c4b7]of _0x457536())_0x1d1072[_0x703b('0x11')](_0x2307e7,_0xa2c4b7);return _0x1d1072;}}