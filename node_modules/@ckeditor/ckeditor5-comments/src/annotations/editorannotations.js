/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x1421=['listenTo','refresh','innerView','function','addSourceCollector','init','directChange','hasDomSelection','set','editorannotations-invalid-source-callback','editing','change:isFocused','remove','fire','refreshSelectedViews','getRanges','getByInnerView','collection','editor','push','model','uiUpdate','isCollapsed','_editorAnnotationsData','getOrderedSelectedAnnotations','containsRange','change:range','element','has','isReadOnly','EditorAnnotations','sort','get','add','map','annotation','range','from','plugins','_dataCollectors','isEqual','view','focusTracker','keys','selection','update','document'];(function(_0x4611c2,_0x1421b9){const _0x4d260c=function(_0xa9efca){while(--_0xa9efca){_0x4611c2['push'](_0x4611c2['shift']());}};_0x4d260c(++_0x1421b9);}(_0x1421,0x18a));const _0x4d26=function(_0x4611c2,_0x1421b9){_0x4611c2=_0x4611c2-0x0;let _0x4d260c=_0x1421[_0x4611c2];return _0x4d260c;};import{Plugin as _0x15a8a8}from'ckeditor5/src/core';import{CKEditorError as _0x9d48fc}from'ckeditor5/src/utils';import{debounce as _0x59adbf}from'lodash-es';import _0x3e3dc4 from'./annotations';export default class V extends _0x15a8a8{static get['requires'](){return[_0x3e3dc4];}static get['pluginName'](){return _0x4d26('0xc');}constructor(_0x38441b){super(_0x38441b),this[_0x4d26('0x15')]=new Set();}[_0x4d26('0x22')](){const _0x15f3c4=this[_0x4d26('0x0')],_0x426a5f=_0x15f3c4[_0x4d26('0x14')][_0x4d26('0xe')](_0x3e3dc4),_0x18cb3c=_0x15f3c4[_0x4d26('0x2')][_0x4d26('0x1c')][_0x4d26('0x1a')],_0xa20e82=_0x59adbf(()=>this[_0x4d26('0x2b')](),0xa);_0x18cb3c['on'](_0x4d26('0x8'),(_0x5d82b0,_0x43d9da)=>{_0x43d9da[_0x4d26('0x23')]&&(_0xa20e82['cancel'](),this['refreshSelectedViews']());}),this[_0x4d26('0x1d')](_0x15f3c4[_0x4d26('0x27')]['view']['document'],_0x4d26('0x28'),(_0x1c4368,_0x5b7dc6,_0x2b00b3)=>{_0x2b00b3&&_0xa20e82();}),this[_0x4d26('0x1d')](_0x15f3c4['ui'][_0x4d26('0x18')],_0x4d26('0x28'),(_0x31a3d6,_0x5e1555,_0x2909aa)=>{_0x2909aa||_0x15f3c4[_0x4d26('0xb')]||this['fire']('blur',{'isAnnotationTracked':_0xdd742e=>this[_0x4d26('0x5')][_0x4d26('0xa')](_0xdd742e['innerView'])});}),this[_0x4d26('0x1d')](this[_0x4d26('0x0')]['ui'],_0x4d26('0x1b'),()=>this['fire'](_0x4d26('0x3')));const _0x17aefd=new Set();this[_0x4d26('0x1d')](_0x426a5f[_0x4d26('0x2e')],'add',(_0x5e2160,_0x257c2c)=>{for(const _0x5c78f2 of this['_editorAnnotationsData'][_0x4d26('0x19')]())if(_0x5c78f2===_0x257c2c[_0x4d26('0x1f')]){_0x15f3c4['ui'][_0x4d26('0x18')][_0x4d26('0xf')](_0x257c2c[_0x4d26('0x17')][_0x4d26('0x9')]),_0x17aefd['add'](_0x257c2c[_0x4d26('0x17')]);break;}}),this[_0x4d26('0x1d')](_0x426a5f[_0x4d26('0x2e')],_0x4d26('0x29'),(_0x821fb8,_0x57d102)=>{_0x17aefd[_0x4d26('0xa')](_0x57d102[_0x4d26('0x17')])&&(_0x15f3c4['ui'][_0x4d26('0x18')][_0x4d26('0x29')](_0x57d102[_0x4d26('0x17')][_0x4d26('0x9')]),_0x17aefd['delete'](_0x57d102[_0x4d26('0x17')]));});}[_0x4d26('0x24')](){return this[_0x4d26('0x0')]['editing'][_0x4d26('0x17')][_0x4d26('0x24')];}[_0x4d26('0x21')](_0x283e65){if(_0x4d26('0x20')!=typeof _0x283e65)throw new _0x9d48fc(_0x4d26('0x26'));this[_0x4d26('0x15')][_0x4d26('0xf')](_0x283e65);}[_0x4d26('0x2b')](){this[_0x4d26('0x2a')](_0x4d26('0x1e'));}[_0x4d26('0x6')]({activeAnnotation:_0x453af7,annotations:_0x2f2035}){const _0x1b6ebb=[],_0x351aab=this[_0x4d26('0x0')][_0x4d26('0x2')][_0x4d26('0x1c')]['selection'],_0x21c9e8=Array[_0x4d26('0x13')](_0x351aab[_0x4d26('0x2c')]());for(const [_0x125a7f,_0x4c7b4b]of this[_0x4d26('0x5')]){const _0x4bd058=_0x1f9e1a(_0x4c7b4b),_0x2b2922=_0x2f2035[_0x4d26('0x2d')](_0x125a7f);_0x4bd058&&_0x2b2922&&_0x1b6ebb[_0x4d26('0x1')]({'annotation':_0x2b2922,'range':_0x4bd058});}function _0x1f9e1a(_0x4a0849){for(const _0x3e9234 of _0x4a0849)for(const _0x202c79 of _0x21c9e8)if(_0x3e9234[_0x4d26('0x7')](_0x202c79,!_0x351aab[_0x4d26('0x4')]))return _0x3e9234;return null;}return _0x1b6ebb[_0x4d26('0xd')]((_0x1d610c,_0x14b525)=>{const _0x403e90=_0x1d610c[_0x4d26('0x12')],_0x214ed9=_0x14b525[_0x4d26('0x12')];if(!_0x403e90[_0x4d26('0x16')](_0x214ed9)){if(_0x403e90['containsRange'](_0x214ed9,!0x0))return 0x1;if(_0x214ed9['containsRange'](_0x403e90,!0x0))return-0x1;}return _0x1d610c[_0x4d26('0x11')]==_0x453af7?-0x1:_0x14b525[_0x4d26('0x11')]==_0x453af7?0x1:0x0;})[_0x4d26('0x10')](_0x236e80=>_0x236e80[_0x4d26('0x11')]);}get[_0x4d26('0x5')](){const _0x3c8f5b=new Map();for(const _0x46f1d3 of Array[_0x4d26('0x13')](this['_dataCollectors']))for(const [_0x1a230f,_0x108079]of _0x46f1d3())_0x3c8f5b[_0x4d26('0x25')](_0x1a230f,_0x108079);return _0x3c8f5b;}}