/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x5e26=['resize','mousedown','_destroyEditorAnnotationsIntegration','change:container','activeAnnotation','destroy','low','delete','remove','_manuallyClosedAnnotationViews','EditorAnnotations','isVisible','listenTo','includes','hasDomSelection','addEventListener','view','editors','blur','init','northArrowSouthEast','high','setActiveAnnotation','narrowsidebar-attach-already-attached','stopPropagation','bodyCollection','northArrowSouthWest','length','has','_attachListeners','narrowsidebar-detach-not-attached','attach','pluginName','content','create','from','_showBalloon','change:height','stop','_throttledRefreshPositioning','Sidebar','get','refresh','element','number','preventClosingBalloon','rearrange','isAttached','annotationType','addAnnotation','_refreshPositioning','register','defaultPositions','unpin','_domEmitter','preventDefault','balloonPanelView','_editorAnnotations','detach','contains','southArrowNorthWest','attachToDom','pin','getSidebarItemView','_annotationToNarrowView','context','_updateBalloonPosition','plugins','isDirty','locale','refreshPositioning','ready','focus','_annotations','target','_hideBalloon','_detachFromContainer','narrowSidebar','esc','_selectedAnnotations','clear','execute','getByView','ck-sidebar--narrow','add','values','stopListening','_setSelectedAnnotations','bind','type','uiUpdate','keydown','keyCode','_detachListeners','removeEventListener','_integrateWithEditorAnnotations','first'];(function(_0x148a9e,_0x5e2673){const _0x58e5df=function(_0x19e3fe){while(--_0x19e3fe){_0x148a9e['push'](_0x148a9e['shift']());}};_0x58e5df(++_0x5e2673);}(_0x5e26,0x69));const _0x58e5=function(_0x148a9e,_0x5e2673){_0x148a9e=_0x148a9e-0x0;let _0x58e5df=_0x5e26[_0x148a9e];return _0x58e5df;};import{ContextPlugin as _0x313156}from'ckeditor5/src/core';import _0x49def1 from'./annotationsuis';import _0x306749 from'./sidebar';import _0x239eb3 from'./view/annotationcounterbuttonview';import{BalloonPanelView as _0x23aed9,BodyCollection as _0x21b295}from'ckeditor5/src/ui';import{CKEditorError as _0x19b1a3,DomEmitterMixin as _0x547266,keyCodes as _0x27fc61,Collection as _0x11c168}from'ckeditor5/src/utils';import'../../theme/sidebar-narrow.css';import{throttle as _0x20a860}from'lodash-es';export default class s extends _0x313156{static get['requires'](){return[_0x306749,_0x49def1];}static get[_0x58e5('0x18')](){return'NarrowSidebar';}constructor(_0xc73979){super(_0xc73979),this[_0x58e5('0x27')]=!0x1,this['_manuallyClosedAnnotationViews']=new Set(),this[_0x58e5('0x2e')]=Object[_0x58e5('0x1a')](_0x547266),this[_0x58e5('0x38')]=new Map(),this['set'](_0x58e5('0x5d'),null),this[_0x58e5('0x41')]=null,this[_0x58e5('0x47')]=[],this[_0x58e5('0x31')]=new _0x11c168(),this[_0x58e5('0x1f')]=_0x20a860(()=>{this['_refreshPositioning']();},0x190,{'leading':!0x1});}[_0x58e5('0xb')](){this[_0x58e5('0x39')][_0x58e5('0x3b')]['get'](_0x49def1)[_0x58e5('0x2b')](_0x58e5('0x45'),this),this[_0x58e5('0x11')]=new _0x21b295(this[_0x58e5('0x39')][_0x58e5('0x3d')]),this['balloonPanelView']=new _0x23aed9(this['context'][_0x58e5('0x3d')]),this[_0x58e5('0x11')][_0x58e5('0x35')](),this[_0x58e5('0x11')][_0x58e5('0x4c')](this['balloonPanelView']);}['attach'](_0x2034e2){this[_0x58e5('0x41')]=_0x2034e2;const _0x2e4f57=this[_0x58e5('0x39')][_0x58e5('0x3b')][_0x58e5('0x21')](_0x306749),_0x1f506e=this[_0x58e5('0x30')];if(_0x2e4f57[_0x58e5('0x41')]=_0x2034e2,this['isAttached'])throw new _0x19b1a3(_0x58e5('0xf'),this);this[_0x58e5('0x27')]=!0x0,this['listenTo'](_0x2e4f57,'set:container',()=>{this['detach'](),this[_0x58e5('0x4')](_0x2e4f57,_0x58e5('0x5c'),_0x4bd08d=>{_0x4bd08d['off'](),this[_0x58e5('0x17')](_0x2034e2);});}),_0x2e4f57['_attachToContainer']({'viewClass':_0x58e5('0x4b'),'spaceBetweenItems':0x5});const _0x4cb2e8=_0x5660e4=>{const _0x9554b4=new _0x239eb3(this[_0x58e5('0x39')][_0x58e5('0x3d')]);_0x2e4f57[_0x58e5('0x29')](_0x5660e4,_0x9554b4),this['_annotationToNarrowView']['set'](_0x5660e4,_0x9554b4),_0x9554b4[_0x58e5('0x50')](_0x58e5('0x3c'),_0x58e5('0x28'),_0x58e5('0x24'))['to'](_0x5660e4['view'],_0x58e5('0x3c'),_0x58e5('0x51'),_0x58e5('0x13')),_0x9554b4['on'](_0x58e5('0x49'),()=>{this[_0x58e5('0x1')][_0x58e5('0x48')](),_0x1f506e[_0x58e5('0x19')][_0x58e5('0x58')]!==_0x5660e4[_0x58e5('0x8')]?(this[_0x58e5('0x1c')](_0x5660e4),_0x5660e4[_0x58e5('0x8')][_0x58e5('0x23')][_0x58e5('0x40')](),this[_0x58e5('0xe')](_0x5660e4)):this[_0x58e5('0xe')](null);});};for(const _0x218b7c of _0x2034e2)_0x4cb2e8(_0x218b7c);this[_0x58e5('0x4')](_0x2034e2,_0x58e5('0x4c'),(_0x390ce7,_0x210add)=>{_0x4cb2e8(_0x210add);}),this['listenTo'](_0x2034e2,_0x58e5('0x0'),(_0x24708f,_0x1a9d5d,_0x34f655)=>{this[_0x58e5('0x38')][_0x58e5('0x21')](_0x1a9d5d)['destroy'](),this['_annotationToNarrowView'][_0x58e5('0x60')](_0x1a9d5d),_0x2e4f57[_0x58e5('0x26')]({'removedAnnotation':_0x1a9d5d,'previousAnnotation':_0x2034e2[_0x58e5('0x21')](_0x34f655-0x1),'nextAnnotation':_0x2034e2[_0x58e5('0x21')](_0x34f655+0x1)}),_0x1a9d5d===this[_0x58e5('0x5d')]&&this[_0x58e5('0xe')](null);},{'priority':_0x58e5('0x5f')}),this[_0x58e5('0x4')](_0x2034e2,_0x58e5('0x40'),(_0x354a5f,_0x38d1f9)=>{this[_0x58e5('0xe')](_0x38d1f9);}),this[_0x58e5('0x4')](_0x2034e2,'blur',()=>{this[_0x58e5('0xe')](null);}),this['_domEmitter'][_0x58e5('0x4')](document,_0x58e5('0x53'),(_0x46742f,_0x1efee6)=>{_0x1efee6[_0x58e5('0x54')]===_0x27fc61[_0x58e5('0x46')]&&_0x1f506e[_0x58e5('0x3')]&&(this[_0x58e5('0x1')][_0x58e5('0x4c')](_0x1f506e['content'][_0x58e5('0x58')]),this[_0x58e5('0x43')](),_0x1efee6[_0x58e5('0x10')](),_0x1efee6[_0x58e5('0x2f')]());}),this[_0x58e5('0x2e')][_0x58e5('0x4')](document,'mousedown',(_0x4480a5,_0x137be4)=>{const _0x25ac4d=_0x137be4[_0x58e5('0x42')];_0x1f506e['isVisible']&&_0x1f506e['element']['contains'](_0x25ac4d)||_0x2e4f57[_0x58e5('0x8')][_0x58e5('0x23')][_0x58e5('0x33')](_0x25ac4d)||_0x4480a5[_0x58e5('0x25')]||(this[_0x58e5('0x1')][_0x58e5('0x48')](),this['_hideBalloon'](),this[_0x58e5('0xe')](null));});const _0x30be80=this[_0x58e5('0x39')][_0x58e5('0x9')]?this[_0x58e5('0x39')][_0x58e5('0x9')]:new _0x11c168([this[_0x58e5('0x39')]]);for(const _0x534615 of _0x30be80)this['_integrateWithEditorAnnotations'](_0x534615);this[_0x58e5('0x4')](_0x30be80,_0x58e5('0x4c'),(_0x503a66,_0x530f67)=>{this[_0x58e5('0x4')](_0x530f67,_0x58e5('0x3f'),()=>{this[_0x58e5('0x57')](_0x530f67);});}),this[_0x58e5('0x4')](_0x30be80,_0x58e5('0x0'),(_0x1c79a8,_0x3bef02)=>{_0x3bef02[_0x58e5('0x3b')][_0x58e5('0x14')](_0x58e5('0x2'))&&this[_0x58e5('0x5b')](_0x3bef02[_0x58e5('0x3b')][_0x58e5('0x21')](_0x58e5('0x2')));}),window[_0x58e5('0x7')](_0x58e5('0x59'),this[_0x58e5('0x1f')]),this[_0x58e5('0x2a')]();}[_0x58e5('0xe')](_0x384535){if(_0x384535===this[_0x58e5('0x5d')])return;const _0x137bf1=this['context'][_0x58e5('0x3b')]['get']('Sidebar');if(_0x137bf1[_0x58e5('0x22')]({'blurredAnnotation':this[_0x58e5('0x5d')],'activatedAnnotation':_0x384535,'disableAnimationOnActivatedAnnotation':!0x0}),_0x384535)_0x137bf1[_0x58e5('0x37')](_0x384535)?this[_0x58e5('0x1c')](_0x384535):this[_0x58e5('0x43')]();else this['_hideBalloon']();this[_0x58e5('0x5d')]=_0x384535;}[_0x58e5('0x32')](){if(!this[_0x58e5('0x27')])throw new _0x19b1a3(_0x58e5('0x16'),this);this[_0x58e5('0xe')](null);const _0x1c0307=this['context'][_0x58e5('0x3b')][_0x58e5('0x21')](_0x58e5('0x20'));this[_0x58e5('0x43')](),Array['from'](this[_0x58e5('0x38')][_0x58e5('0x4d')](),_0x2f3fcc=>_0x2f3fcc[_0x58e5('0x5e')]()),this['_annotationToNarrowView'][_0x58e5('0x48')](),_0x1c0307[_0x58e5('0x44')](this[_0x58e5('0x41')]),this[_0x58e5('0x4e')](),this[_0x58e5('0x2e')][_0x58e5('0x4e')](),this[_0x58e5('0x4e')](this[_0x58e5('0x39')][_0x58e5('0x9')]);for(const _0x4ba6ef of Array[_0x58e5('0x1b')](this[_0x58e5('0x31')]))this[_0x58e5('0x5b')](_0x4ba6ef);window[_0x58e5('0x56')](_0x58e5('0x59'),this['_throttledRefreshPositioning']),this['_throttledRefreshPositioning']['cancel'](),this[_0x58e5('0x47')]=[],this['isAttached']=!0x1,this[_0x58e5('0x41')]=null;}[_0x58e5('0x5e')](){this['isAttached']&&this[_0x58e5('0x32')](),this['bodyCollection']['detachFromDom']();}[_0x58e5('0x57')](_0x5d5311){const _0x14bca9=_0x5d5311[_0x58e5('0x3b')][_0x58e5('0x21')](_0x58e5('0x2')),_0x705316=this[_0x58e5('0x39')][_0x58e5('0x3b')][_0x58e5('0x21')](_0x306749),_0x15defa=this['_annotations'],_0x1f7ddc=this[_0x58e5('0x30')],_0x298182=()=>{const _0x37ee04=_0x14bca9['getOrderedSelectedAnnotations']({'activeAnnotation':this['activeAnnotation'],'annotations':this['_annotations']});this['_setSelectedAnnotations'](_0x37ee04),this[_0x58e5('0xe')](_0x37ee04[0x0]||null);};this[_0x58e5('0x4')](_0x14bca9,'refresh',_0x298182),this[_0x58e5('0x4')](_0x14bca9,'blur',(_0x55767a,{isAnnotationTracked:_0x12774b})=>{this[_0x58e5('0x5d')]&&_0x12774b(this[_0x58e5('0x5d')])&&(this[_0x58e5('0x4f')]([]),this[_0x58e5('0xe')](null));}),this[_0x58e5('0x4')](_0x14bca9,_0x58e5('0x52'),()=>{this[_0x58e5('0x1f')]();}),this[_0x58e5('0x4')](_0x15defa,_0x58e5('0xa'),_0x499a27=>{_0x14bca9[_0x58e5('0x6')]()&&_0x499a27[_0x58e5('0x1e')]();},{'priority':_0x58e5('0xd')}),this[_0x58e5('0x2e')][_0x58e5('0x4')](document,_0x58e5('0x5a'),(_0x34ec50,_0x40b3d6)=>{const _0x34b8fa=_0x40b3d6[_0x58e5('0x42')];_0x1f7ddc[_0x58e5('0x3')]&&_0x1f7ddc[_0x58e5('0x23')]['contains'](_0x34b8fa)||_0x705316[_0x58e5('0x8')][_0x58e5('0x23')][_0x58e5('0x33')](_0x34b8fa)||this[_0x58e5('0x5d')]&&_0x14bca9['hasDomSelection']()&&(_0x298182(),_0x34ec50[_0x58e5('0x25')]=!0x0);},{'priority':_0x58e5('0xd')}),this[_0x58e5('0x31')][_0x58e5('0x4c')](_0x14bca9);}[_0x58e5('0x5b')](_0x4413f8){_0x4413f8&&(this['stopListening'](_0x4413f8),this[_0x58e5('0x31')][_0x58e5('0x0')](_0x4413f8));}['_setSelectedAnnotations'](_0x3b3569){for(const _0x2cb21e of this[_0x58e5('0x47')])_0x3b3569[_0x58e5('0x5')](_0x2cb21e)||this[_0x58e5('0x1')][_0x58e5('0x60')](_0x2cb21e[_0x58e5('0x8')]);this[_0x58e5('0x47')]=_0x3b3569;}[_0x58e5('0x2a')](){const _0x473a23=this[_0x58e5('0x30')];this[_0x58e5('0x41')][_0x58e5('0x3e')](),_0x473a23[_0x58e5('0x3')]&&this[_0x58e5('0x3a')]();}[_0x58e5('0x1c')](_0x52eb46){if(this[_0x58e5('0x1')]['has'](_0x52eb46[_0x58e5('0x8')]))return;const _0x1a5be4=this[_0x58e5('0x30')][_0x58e5('0x19')]['first'];_0x1a5be4!==_0x52eb46[_0x58e5('0x8')]?(_0x1a5be4&&this[_0x58e5('0x55')](_0x1a5be4),this[_0x58e5('0x15')](_0x52eb46[_0x58e5('0x8')]),this[_0x58e5('0x30')][_0x58e5('0x19')][_0x58e5('0x48')](),this[_0x58e5('0x30')][_0x58e5('0x19')][_0x58e5('0x4c')](_0x52eb46[_0x58e5('0x8')]),this[_0x58e5('0x3a')]()):this[_0x58e5('0x3a')]();}[_0x58e5('0x3a')](){const _0x1482fd=this[_0x58e5('0x30')]['content'][_0x58e5('0x58')],_0x58bb63=this[_0x58e5('0x41')][_0x58e5('0x4a')](_0x1482fd);if(!this[_0x58e5('0x38')][_0x58e5('0x14')](_0x58bb63))return;const _0x585b6c=this[_0x58e5('0x38')][_0x58e5('0x21')](_0x58bb63)[_0x58e5('0x23')],_0x40257e=function(){const _0x53e990=_0x23aed9[_0x58e5('0x2c')];return[_0x53e990['southArrowNorthEast'],_0x53e990[_0x58e5('0xc')],_0x53e990['southArrowNorth'],_0x53e990['northArrowSouth'],_0x53e990[_0x58e5('0x34')],_0x53e990[_0x58e5('0x12')]];}();this['balloonPanelView'][_0x58e5('0x36')]({'target':_0x585b6c,'positions':_0x40257e});}['_hideBalloon'](){const _0xb05b2a=this[_0x58e5('0x30')],_0x14f037=_0xb05b2a[_0x58e5('0x19')]['first'];_0x14f037&&(this[_0x58e5('0x55')](_0x14f037),_0xb05b2a[_0x58e5('0x2d')](),_0xb05b2a[_0x58e5('0x19')]['clear']());}['_attachListeners'](_0x7c7e73){this[_0x58e5('0x4')](_0x7c7e73,_0x58e5('0x1d'),()=>this['_updateBalloonPosition']()),this['listenTo'](_0x7c7e73,'Esc',(_0x2105a9,_0x3bd61f)=>{this[_0x58e5('0x1')][_0x58e5('0x4c')](_0x7c7e73),this[_0x58e5('0x43')](),_0x3bd61f();});}[_0x58e5('0x55')](_0x1c3044){this[_0x58e5('0x4e')](_0x1c3044);}}