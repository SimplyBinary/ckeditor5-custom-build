/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x4109=['bodyCollection','_detachListeners','isVisible','_refreshPositioning','preventClosingBalloon','EditorAnnotations','length','_integrateWithEditorAnnotations','Esc','blur','keyCode','_attachToContainer','_detachFromContainer','context','has','refresh','_updateBalloonPosition','first','execute','mousedown','_hideBalloon','isAttached','view','change:container','remove','off','southArrowNorth','from','resize','editors','element','_throttledRefreshPositioning','pin','detach','get','addEventListener','getSidebarItemView','unpin','_showBalloon','register','narrowSidebar','detachFromDom','rearrange','focus','cancel','stop','setActiveAnnotation','_domEmitter','clear','delete','narrowsidebar-attach-already-attached','_attachListeners','locale','_setSelectedAnnotations','_editorAnnotations','_annotations','_selectedAnnotations','getByView','set','hasDomSelection','removeEventListener','_destroyEditorAnnotationsIntegration','values','includes','uiUpdate','refreshPositioning','add','attach','type','init','listenTo','attachToDom','northArrowSouthWest','_annotationToNarrowView','set:container','target','plugins','activeAnnotation','destroy','isDirty','northArrowSouth','stopListening','content','_manuallyClosedAnnotationViews','pluginName','getOrderedSelectedAnnotations','balloonPanelView','bind','contains'];(function(_0x2b08ca,_0x4109ef){const _0x149e60=function(_0x47c522){while(--_0x47c522){_0x2b08ca['push'](_0x2b08ca['shift']());}};_0x149e60(++_0x4109ef);}(_0x4109,0x118));const _0x149e=function(_0x2b08ca,_0x4109ef){_0x2b08ca=_0x2b08ca-0x0;let _0x149e60=_0x4109[_0x2b08ca];return _0x149e60;};import{ContextPlugin as _0x41d2a7}from'ckeditor5/src/core';import _0x25ca17 from'./annotationsuis';import _0x3730a4 from'./sidebar';import _0xddd155 from'./view/annotationcounterbuttonview';import{BalloonPanelView as _0x344a29,BodyCollection as _0x394ed0}from'ckeditor5/src/ui';import{CKEditorError as _0x2a189d,DomEmitterMixin as _0xbe4cda,keyCodes as _0x20d6be,Collection as _0x2da181}from'ckeditor5/src/utils';import'../../theme/sidebar-narrow.css';import{throttle as _0x26e246}from'lodash-es';export default class s extends _0x41d2a7{static get['requires'](){return[_0x3730a4,_0x25ca17];}static get[_0x149e('0x47')](){return'NarrowSidebar';}constructor(_0x20a24b){super(_0x20a24b),this[_0x149e('0x8')]=!0x1,this['_manuallyClosedAnnotationViews']=new Set(),this[_0x149e('0x22')]=Object['create'](_0xbe4cda),this['_annotationToNarrowView']=new Map(),this[_0x149e('0x2d')](_0x149e('0x40'),null),this['_annotations']=null,this[_0x149e('0x2b')]=[],this['_editorAnnotations']=new _0x2da181(),this['_throttledRefreshPositioning']=_0x26e246(()=>{this[_0x149e('0x4f')]();},0x190,{'leading':!0x1});}[_0x149e('0x38')](){this[_0x149e('0x0')][_0x149e('0x3f')][_0x149e('0x15')](_0x25ca17)[_0x149e('0x1a')](_0x149e('0x1b'),this),this[_0x149e('0x4c')]=new _0x394ed0(this[_0x149e('0x0')][_0x149e('0x27')]),this[_0x149e('0x49')]=new _0x344a29(this[_0x149e('0x0')][_0x149e('0x27')]),this['bodyCollection'][_0x149e('0x3a')](),this['bodyCollection'][_0x149e('0x35')](this['balloonPanelView']);}[_0x149e('0x36')](_0x1c4ee3){this[_0x149e('0x2a')]=_0x1c4ee3;const _0x3146e2=this['context'][_0x149e('0x3f')][_0x149e('0x15')](_0x3730a4),_0x3b539d=this['balloonPanelView'];if(_0x3146e2[_0x149e('0x2a')]=_0x1c4ee3,this['isAttached'])throw new _0x2a189d(_0x149e('0x25'),this);this[_0x149e('0x8')]=!0x0,this[_0x149e('0x39')](_0x3146e2,_0x149e('0x3d'),()=>{this[_0x149e('0x14')](),this[_0x149e('0x39')](_0x3146e2,_0x149e('0xa'),_0x1e5241=>{_0x1e5241[_0x149e('0xc')](),this[_0x149e('0x36')](_0x1c4ee3);});}),_0x3146e2[_0x149e('0x57')]({'viewClass':'ck-sidebar--narrow','spaceBetweenItems':0x5});const _0x4603f4=_0x38e9df=>{const _0x504c28=new _0xddd155(this[_0x149e('0x0')][_0x149e('0x27')]);_0x3146e2['addAnnotation'](_0x38e9df,_0x504c28),this[_0x149e('0x3c')][_0x149e('0x2d')](_0x38e9df,_0x504c28),_0x504c28[_0x149e('0x4a')](_0x149e('0x42'),'annotationType','number')['to'](_0x38e9df['view'],_0x149e('0x42'),_0x149e('0x37'),_0x149e('0x52')),_0x504c28['on'](_0x149e('0x5'),()=>{this[_0x149e('0x46')][_0x149e('0x23')](),_0x3b539d[_0x149e('0x45')][_0x149e('0x4')]!==_0x38e9df[_0x149e('0x9')]?(this[_0x149e('0x19')](_0x38e9df),_0x38e9df[_0x149e('0x9')][_0x149e('0x11')][_0x149e('0x1e')](),this[_0x149e('0x21')](_0x38e9df)):this[_0x149e('0x21')](null);});};for(const _0x357fc9 of _0x1c4ee3)_0x4603f4(_0x357fc9);this[_0x149e('0x39')](_0x1c4ee3,_0x149e('0x35'),(_0x3e133b,_0x194e73)=>{_0x4603f4(_0x194e73);}),this['listenTo'](_0x1c4ee3,_0x149e('0xb'),(_0x49f730,_0x31d7d4,_0x26ad97)=>{this[_0x149e('0x3c')][_0x149e('0x15')](_0x31d7d4)[_0x149e('0x41')](),this[_0x149e('0x3c')][_0x149e('0x24')](_0x31d7d4),_0x3146e2[_0x149e('0x1d')]({'removedAnnotation':_0x31d7d4,'previousAnnotation':_0x1c4ee3[_0x149e('0x15')](_0x26ad97-0x1),'nextAnnotation':_0x1c4ee3[_0x149e('0x15')](_0x26ad97+0x1)}),_0x31d7d4===this[_0x149e('0x40')]&&this[_0x149e('0x21')](null);},{'priority':'low'}),this['listenTo'](_0x1c4ee3,_0x149e('0x1e'),(_0x548029,_0x35351c)=>{this['setActiveAnnotation'](_0x35351c);}),this[_0x149e('0x39')](_0x1c4ee3,_0x149e('0x55'),()=>{this[_0x149e('0x21')](null);}),this[_0x149e('0x22')]['listenTo'](document,'keydown',(_0x281091,_0x454dcc)=>{_0x454dcc[_0x149e('0x56')]===_0x20d6be['esc']&&_0x3b539d[_0x149e('0x4e')]&&(this['_manuallyClosedAnnotationViews'][_0x149e('0x35')](_0x3b539d[_0x149e('0x45')][_0x149e('0x4')]),this[_0x149e('0x7')](),_0x454dcc['stopPropagation'](),_0x454dcc['preventDefault']());}),this[_0x149e('0x22')]['listenTo'](document,_0x149e('0x6'),(_0x5c8b83,_0x2050d7)=>{const _0x480aab=_0x2050d7[_0x149e('0x3e')];_0x3b539d[_0x149e('0x4e')]&&_0x3b539d[_0x149e('0x11')][_0x149e('0x4b')](_0x480aab)||_0x3146e2[_0x149e('0x9')]['element'][_0x149e('0x4b')](_0x480aab)||_0x5c8b83[_0x149e('0x50')]||(this[_0x149e('0x46')][_0x149e('0x23')](),this[_0x149e('0x7')](),this[_0x149e('0x21')](null));});const _0x2b42e2=this[_0x149e('0x0')]['editors']?this[_0x149e('0x0')][_0x149e('0x10')]:new _0x2da181([this[_0x149e('0x0')]]);for(const _0x4f5ae3 of _0x2b42e2)this['_integrateWithEditorAnnotations'](_0x4f5ae3);this['listenTo'](_0x2b42e2,_0x149e('0x35'),(_0x222a5e,_0x18cb84)=>{this['listenTo'](_0x18cb84,'ready',()=>{this[_0x149e('0x53')](_0x18cb84);});}),this[_0x149e('0x39')](_0x2b42e2,_0x149e('0xb'),(_0x59d793,_0x58b7fd)=>{_0x58b7fd[_0x149e('0x3f')]['has'](_0x149e('0x51'))&&this[_0x149e('0x30')](_0x58b7fd[_0x149e('0x3f')][_0x149e('0x15')](_0x149e('0x51')));}),window[_0x149e('0x16')](_0x149e('0xf'),this[_0x149e('0x12')]),this[_0x149e('0x4f')]();}['setActiveAnnotation'](_0x28f6b8){if(_0x28f6b8===this[_0x149e('0x40')])return;const _0x2eac12=this[_0x149e('0x0')]['plugins']['get']('Sidebar');if(_0x2eac12[_0x149e('0x2')]({'blurredAnnotation':this['activeAnnotation'],'activatedAnnotation':_0x28f6b8,'disableAnimationOnActivatedAnnotation':!0x0}),_0x28f6b8)_0x2eac12[_0x149e('0x17')](_0x28f6b8)?this[_0x149e('0x19')](_0x28f6b8):this[_0x149e('0x7')]();else this[_0x149e('0x7')]();this[_0x149e('0x40')]=_0x28f6b8;}['detach'](){if(!this[_0x149e('0x8')])throw new _0x2a189d('narrowsidebar-detach-not-attached',this);this['setActiveAnnotation'](null);const _0x17c60b=this[_0x149e('0x0')][_0x149e('0x3f')]['get']('Sidebar');this[_0x149e('0x7')](),Array[_0x149e('0xe')](this[_0x149e('0x3c')][_0x149e('0x31')](),_0x396d0e=>_0x396d0e[_0x149e('0x41')]()),this[_0x149e('0x3c')]['clear'](),_0x17c60b[_0x149e('0x58')](this[_0x149e('0x2a')]),this[_0x149e('0x44')](),this[_0x149e('0x22')][_0x149e('0x44')](),this['stopListening'](this[_0x149e('0x0')][_0x149e('0x10')]);for(const _0x57076b of Array['from'](this['_editorAnnotations']))this[_0x149e('0x30')](_0x57076b);window[_0x149e('0x2f')](_0x149e('0xf'),this['_throttledRefreshPositioning']),this[_0x149e('0x12')][_0x149e('0x1f')](),this[_0x149e('0x2b')]=[],this['isAttached']=!0x1,this[_0x149e('0x2a')]=null;}[_0x149e('0x41')](){this[_0x149e('0x8')]&&this[_0x149e('0x14')](),this[_0x149e('0x4c')][_0x149e('0x1c')]();}[_0x149e('0x53')](_0x40a17f){const _0x1a5c1b=_0x40a17f[_0x149e('0x3f')][_0x149e('0x15')](_0x149e('0x51')),_0x29634d=this[_0x149e('0x0')]['plugins'][_0x149e('0x15')](_0x3730a4),_0x1ed67f=this[_0x149e('0x2a')],_0x31f84c=this['balloonPanelView'],_0x3de6cc=()=>{const _0x5969e4=_0x1a5c1b[_0x149e('0x48')]({'activeAnnotation':this[_0x149e('0x40')],'annotations':this[_0x149e('0x2a')]});this[_0x149e('0x28')](_0x5969e4),this['setActiveAnnotation'](_0x5969e4[0x0]||null);};this[_0x149e('0x39')](_0x1a5c1b,_0x149e('0x2'),_0x3de6cc),this['listenTo'](_0x1a5c1b,_0x149e('0x55'),(_0xb4f5a8,{isAnnotationTracked:_0x4033ab})=>{this[_0x149e('0x40')]&&_0x4033ab(this[_0x149e('0x40')])&&(this[_0x149e('0x28')]([]),this[_0x149e('0x21')](null));}),this[_0x149e('0x39')](_0x1a5c1b,_0x149e('0x33'),()=>{this['_throttledRefreshPositioning']();}),this['listenTo'](_0x1ed67f,_0x149e('0x55'),_0x358abf=>{_0x1a5c1b['hasDomSelection']()&&_0x358abf[_0x149e('0x20')]();},{'priority':'high'}),this[_0x149e('0x22')]['listenTo'](document,_0x149e('0x6'),(_0x53d272,_0xa64762)=>{const _0x1a9a36=_0xa64762[_0x149e('0x3e')];_0x31f84c['isVisible']&&_0x31f84c[_0x149e('0x11')][_0x149e('0x4b')](_0x1a9a36)||_0x29634d[_0x149e('0x9')][_0x149e('0x11')][_0x149e('0x4b')](_0x1a9a36)||this['activeAnnotation']&&_0x1a5c1b[_0x149e('0x2e')]()&&(_0x3de6cc(),_0x53d272[_0x149e('0x50')]=!0x0);},{'priority':'high'}),this[_0x149e('0x29')]['add'](_0x1a5c1b);}[_0x149e('0x30')](_0x2f2da3){_0x2f2da3&&(this[_0x149e('0x44')](_0x2f2da3),this[_0x149e('0x29')][_0x149e('0xb')](_0x2f2da3));}[_0x149e('0x28')](_0x4d5959){for(const _0x5b0f21 of this[_0x149e('0x2b')])_0x4d5959[_0x149e('0x32')](_0x5b0f21)||this['_manuallyClosedAnnotationViews'][_0x149e('0x24')](_0x5b0f21[_0x149e('0x9')]);this[_0x149e('0x2b')]=_0x4d5959;}['_refreshPositioning'](){const _0x5086aa=this[_0x149e('0x49')];this['_annotations'][_0x149e('0x34')](),_0x5086aa[_0x149e('0x4e')]&&this[_0x149e('0x3')]();}[_0x149e('0x19')](_0x14cabe){if(this[_0x149e('0x46')][_0x149e('0x1')](_0x14cabe[_0x149e('0x9')]))return;const _0x5bcf79=this[_0x149e('0x49')]['content'][_0x149e('0x4')];_0x5bcf79!==_0x14cabe[_0x149e('0x9')]?(_0x5bcf79&&this[_0x149e('0x4d')](_0x5bcf79),this['_attachListeners'](_0x14cabe[_0x149e('0x9')]),this[_0x149e('0x49')]['content'][_0x149e('0x23')](),this[_0x149e('0x49')][_0x149e('0x45')][_0x149e('0x35')](_0x14cabe['view']),this[_0x149e('0x3')]()):this[_0x149e('0x3')]();}[_0x149e('0x3')](){const _0x423ad5=this['balloonPanelView'][_0x149e('0x45')][_0x149e('0x4')],_0x141e2b=this[_0x149e('0x2a')][_0x149e('0x2c')](_0x423ad5);if(!this[_0x149e('0x3c')][_0x149e('0x1')](_0x141e2b))return;const _0x5a683e=this[_0x149e('0x3c')][_0x149e('0x15')](_0x141e2b)[_0x149e('0x11')],_0x2ff870=function(){const _0x32b428=_0x344a29['defaultPositions'];return[_0x32b428['southArrowNorthEast'],_0x32b428['northArrowSouthEast'],_0x32b428[_0x149e('0xd')],_0x32b428[_0x149e('0x43')],_0x32b428['southArrowNorthWest'],_0x32b428[_0x149e('0x3b')]];}();this[_0x149e('0x49')][_0x149e('0x13')]({'target':_0x5a683e,'positions':_0x2ff870});}[_0x149e('0x7')](){const _0x2618b0=this[_0x149e('0x49')],_0x4488d9=_0x2618b0[_0x149e('0x45')][_0x149e('0x4')];_0x4488d9&&(this[_0x149e('0x4d')](_0x4488d9),_0x2618b0[_0x149e('0x18')](),_0x2618b0['content'][_0x149e('0x23')]());}[_0x149e('0x26')](_0x38d527){this[_0x149e('0x39')](_0x38d527,'change:height',()=>this[_0x149e('0x3')]()),this['listenTo'](_0x38d527,_0x149e('0x54'),(_0x58342e,_0x375260)=>{this[_0x149e('0x46')]['add'](_0x38d527),this[_0x149e('0x7')](),_0x375260();});}[_0x149e('0x4d')](_0x409a70){this['stopListening'](_0x409a70);}}