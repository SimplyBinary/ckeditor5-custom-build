/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x2f23=['detach','view','isActive','_selectedAnnotations','change:isFocused','document','afterInit','inline','refresh','_annotations','_addAnnotationToBalloon','visibleView','change:visibleView','requires','InlineAnnotations','inlineannotations-detach-not-attached','clear','_setSelectedAnnotations','editor','get','remove','selection','_manuallyClosed','isAttached','has','getSelection','set','blur','focusTracker','includes','showStack','updatePosition','add','hasView','switchTo','context','editing','delete','isFocused','attach','inlineannotations-attach-already-attached','focus','stopListening','Esc','destroy','_removeAnnotationFromBalloon','getByView','register','activeAnnotation','listenTo','mousedown','_addedAnnotations','pluginName','_balloon','plugins','targetRect','setActiveAnnotation','getOrderedSelectedAnnotations','update','bind','hasActive'];(function(_0x574bcd,_0x2f237){const _0x430660=function(_0xa5f99a){while(--_0xa5f99a){_0x574bcd['push'](_0x574bcd['shift']());}};_0x430660(++_0x2f237);}(_0x2f23,0x1d3));const _0x4306=function(_0x574bcd,_0x2f237){_0x574bcd=_0x574bcd-0x0;let _0x430660=_0x2f23[_0x574bcd];return _0x430660;};import{Plugin as _0x2a0d6f}from'ckeditor5/src/core';import _0x1f7a83 from'./annotationsuis';import _0x18b6ef from'./editorannotations';import{ContextualBalloon as _0x347abb}from'ckeditor5/src/ui';import{MouseObserver as _0x1b8dd5}from'ckeditor5/src/engine';import{CKEditorError as _0x65f77d}from'ckeditor5/src/utils';import'./../../theme/annotation-inline.css';export default class a extends _0x2a0d6f{static get[_0x4306('0x22')](){return[_0x18b6ef,_0x347abb,_0x1f7a83];}static get[_0x4306('0xc')](){return _0x4306('0x23');}constructor(_0x81dc0d){super(_0x81dc0d),_0x81dc0d[_0x4306('0x39')][_0x4306('0x16')]['addObserver'](_0x1b8dd5),this[_0x4306('0x2c')]=!0x1,this[_0x4306('0x2f')](_0x4306('0x8'),null),this[_0x4306('0x1e')]=null,this[_0x4306('0x2b')]=new Set(),this[_0x4306('0xd')]=_0x81dc0d[_0x4306('0xe')][_0x4306('0x28')](_0x347abb),this[_0x4306('0xb')]=new Set(),this[_0x4306('0x18')]=[];}['init'](){const _0x387daa=this[_0x4306('0x27')]['plugins'][_0x4306('0x28')](_0x1f7a83);_0x387daa['context']===this[_0x4306('0x27')]&&(_0x387daa[_0x4306('0x7')](_0x4306('0x1c'),this),this[_0x4306('0x27')]['keystrokes'][_0x4306('0x2f')](_0x4306('0x3'),(_0x4759e5,_0x50c5d1)=>{const _0x2cb24f=this[_0x4306('0xd')];if(this['isAttached']&&_0x2cb24f[_0x4306('0x20')]){const _0x1ccc79=this[_0x4306('0x1e')][_0x4306('0x6')](_0x2cb24f[_0x4306('0x20')]);this['_manuallyClosed'][_0x4306('0x35')](_0x1ccc79),this['_removeAnnotationFromBalloon'](_0x1ccc79),_0x50c5d1();}}));}[_0x4306('0x1b')](){const _0x5c044b=this[_0x4306('0x27')][_0x4306('0xe')][_0x4306('0x28')](_0x1f7a83);_0x5c044b['context']===this['editor']&&(_0x5c044b[_0x4306('0x14')]()||_0x5c044b[_0x4306('0x37')]('inline'));}['setActiveAnnotation'](_0x3705b7){_0x3705b7!==this[_0x4306('0x8')]&&(this[_0x4306('0x8')]&&(this['activeAnnotation'][_0x4306('0x17')]=!0x1),_0x3705b7&&this[_0x4306('0x27')]['ui'][_0x4306('0x31')][_0x4306('0x3b')]&&(this[_0x4306('0x1f')](_0x3705b7,!0x0),_0x3705b7[_0x4306('0x17')]=!0x0),_0x3705b7||this[_0x4306('0x26')]([]),this[_0x4306('0x8')]=_0x3705b7);}[_0x4306('0x3c')](_0x4311e7){this[_0x4306('0x1e')]=_0x4311e7;const _0x55ff4d=this[_0x4306('0x27')][_0x4306('0xe')][_0x4306('0x28')](_0x1f7a83),_0x19f62e=this[_0x4306('0xd')];if(this[_0x4306('0x2c')])throw new _0x65f77d(_0x4306('0x0'),this);if(_0x55ff4d[_0x4306('0x38')]!==this['editor'])throw new _0x65f77d('inlineannotations-not-allowed-with-context',this);const _0x515239=this[_0x4306('0x27')][_0x4306('0xe')]['get']('EditorAnnotations');this[_0x4306('0x9')](_0x515239,_0x4306('0x1d'),function(){const _0x2c774b=_0x515239[_0x4306('0x11')]({'activeAnnotation':this[_0x4306('0x8')],'annotations':this[_0x4306('0x1e')]});this[_0x4306('0x26')](_0x2c774b),this['setActiveAnnotation'](_0x2c774b[0x0]||null);}[_0x4306('0x13')](this)),this[_0x4306('0x9')](_0x515239,_0x4306('0x30'),(_0x7e4748,{isAnnotationTracked:_0x45b200})=>{this['activeAnnotation']&&_0x45b200(this[_0x4306('0x8')])&&(this[_0x4306('0x26')]([]),this['setActiveAnnotation'](null));}),this[_0x4306('0x9')](this[_0x4306('0x27')]['ui'][_0x4306('0x31')],_0x4306('0x19'),(_0x41d6ee,_0x4efe7c,_0x393394)=>{_0x393394||this[_0x4306('0x10')](null);}),this[_0x4306('0x9')](_0x4311e7,_0x4306('0x29'),(_0x1bb998,_0x4612e9)=>{this[_0x4306('0x5')](_0x4612e9),_0x4612e9===this[_0x4306('0x8')]&&this[_0x4306('0x10')](null);}),this['listenTo'](_0x19f62e,_0x4306('0x21'),(_0x53008f,_0xce8f4,_0xf42d96,_0x2dfecf)=>{if(_0x2dfecf&&this[_0x4306('0x2')](_0x2dfecf),!_0xf42d96||!_0x4311e7[_0x4306('0x6')](_0xf42d96))return;const _0x3c9b6e=_0x4311e7[_0x4306('0x6')](_0xf42d96);this[_0x4306('0x9')](_0xf42d96,'change:height',()=>{_0x19f62e[_0x4306('0x34')]();}),this['listenTo'](_0xf42d96,'Esc',()=>{this[_0x4306('0x2b')][_0x4306('0x35')](_0x3c9b6e),this[_0x4306('0x5')](_0x3c9b6e),this[_0x4306('0x27')]['editing'][_0x4306('0x16')][_0x4306('0x1')]();}),this[_0x4306('0x8')]!==_0x3c9b6e&&this['setActiveAnnotation'](_0x3c9b6e);}),this[_0x4306('0x9')](this[_0x4306('0x27')]['ui'],_0x4306('0x12'),()=>{_0x19f62e[_0x4306('0x20')]&&(_0x4311e7[_0x4306('0x6')](_0x19f62e[_0x4306('0x20')])&&_0x19f62e[_0x4306('0x34')]());}),this[_0x4306('0x9')](this['editor'][_0x4306('0x39')][_0x4306('0x16')][_0x4306('0x1a')],_0x4306('0xa'),()=>{this['_manuallyClosed'][_0x4306('0x25')]();}),this[_0x4306('0x27')][_0x4306('0x39')][_0x4306('0x16')][_0x4306('0x1a')][_0x4306('0x2a')]['editableElement']&&this[_0x4306('0x27')]['editing'][_0x4306('0x16')]['focus'](),this[_0x4306('0x2c')]=!0x0;}['detach'](){if(!this[_0x4306('0x2c')])throw new _0x65f77d(_0x4306('0x24'),this);this[_0x4306('0x10')](null);for(const _0x468cbb of this[_0x4306('0xb')])this['_removeAnnotationFromBalloon'](_0x468cbb);this[_0x4306('0x2')](),this[_0x4306('0x2c')]=!0x1;}[_0x4306('0x4')](){this[_0x4306('0x2c')]&&this[_0x4306('0x15')]();}['_setSelectedAnnotations'](_0x5574df){const _0x304462=this[_0x4306('0x18')];for(const _0x2e4875 of _0x304462)_0x5574df['includes'](_0x2e4875)||this['_manuallyClosed']['delete'](_0x2e4875);for(const _0x240efe of this['_annotations'])_0x5574df[_0x4306('0x32')](_0x240efe)||this['_removeAnnotationFromBalloon'](_0x240efe);if(this[_0x4306('0x27')]['ui'][_0x4306('0x31')][_0x4306('0x3b')])for(const _0x29165f of _0x5574df)this[_0x4306('0x1f')](_0x29165f);this[_0x4306('0x18')]=_0x5574df;}['_addAnnotationToBalloon'](_0x38f435,_0x3e2bc2){this['_manuallyClosed'][_0x4306('0x2d')](_0x38f435)||(this['_addedAnnotations']['has'](_0x38f435)||this['_balloon'][_0x4306('0x36')](_0x38f435[_0x4306('0x16')])||(this[_0x4306('0xb')][_0x4306('0x35')](_0x38f435),this[_0x4306('0xd')]['add']({'stackId':_0x38f435[_0x4306('0x16')]['id'],'view':_0x38f435[_0x4306('0x16')],'position':{'target':()=>_0x38f435['target']||_0x38f435[_0x4306('0xf')]||document[_0x4306('0x2e')]()['getRangeAt'](0x0)}})),_0x3e2bc2&&this['_balloon'][_0x4306('0x33')](_0x38f435[_0x4306('0x16')]['id']));}['_removeAnnotationFromBalloon'](_0x12df3a){this[_0x4306('0xb')][_0x4306('0x2d')](_0x12df3a)&&this[_0x4306('0xd')][_0x4306('0x36')](_0x12df3a[_0x4306('0x16')])&&(this[_0x4306('0xb')][_0x4306('0x3a')](_0x12df3a),this['_balloon'][_0x4306('0x29')](_0x12df3a[_0x4306('0x16')]));}}