/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3396=['attach','_balloon','getByView','isFocused','isAttached','delete','mousedown','has','listenTo','showStack','Esc','init','editor','visibleView','get','includes','change:visibleView','refresh','context','inlineannotations-not-allowed-with-context','_addAnnotationToBalloon','afterInit','requires','hasActive','addObserver','target','plugins','_annotations','stopListening','document','update','remove','focus','_addedAnnotations','getSelection','inlineannotations-attach-already-attached','targetRect','keystrokes','set','detach','setActiveAnnotation','editing','activeAnnotation','focusTracker','isActive','bind','updatePosition','destroy','selection','getRangeAt','view','hasView','register','pluginName','_removeAnnotationFromBalloon','blur','_selectedAnnotations','_manuallyClosed','switchTo','InlineAnnotations','add','_setSelectedAnnotations'];(function(_0x378820,_0x3396a9){const _0x1aa174=function(_0x132818){while(--_0x132818){_0x378820['push'](_0x378820['shift']());}};_0x1aa174(++_0x3396a9);}(_0x3396,0x14d));const _0x1aa1=function(_0x378820,_0x3396a9){_0x378820=_0x378820-0x0;let _0x1aa174=_0x3396[_0x378820];return _0x1aa174;};import{Plugin as _0x50ef1d}from'ckeditor5/src/core';import _0x3ddb93 from'./annotationsuis';import _0x27b9c8 from'./editorannotations';import{ContextualBalloon as _0x313f07}from'ckeditor5/src/ui';import{MouseObserver as _0x1b0bf3}from'ckeditor5/src/engine';import{CKEditorError as _0x359701}from'ckeditor5/src/utils';import'./../../theme/annotation-inline.css';export default class a extends _0x50ef1d{static get[_0x1aa1('0x3d')](){return[_0x27b9c8,_0x313f07,_0x3ddb93];}static get[_0x1aa1('0x1e')](){return _0x1aa1('0x24');}constructor(_0x4a052f){super(_0x4a052f),_0x4a052f[_0x1aa1('0x12')][_0x1aa1('0x1b')][_0x1aa1('0x1')](_0x1b0bf3),this[_0x1aa1('0x2b')]=!0x1,this[_0x1aa1('0xf')](_0x1aa1('0x13'),null),this[_0x1aa1('0x4')]=null,this[_0x1aa1('0x22')]=new Set(),this[_0x1aa1('0x28')]=_0x4a052f[_0x1aa1('0x3')][_0x1aa1('0x35')](_0x313f07),this[_0x1aa1('0xa')]=new Set(),this[_0x1aa1('0x21')]=[];}[_0x1aa1('0x32')](){const _0x42a92c=this['editor'][_0x1aa1('0x3')][_0x1aa1('0x35')](_0x3ddb93);_0x42a92c[_0x1aa1('0x39')]===this[_0x1aa1('0x33')]&&(_0x42a92c[_0x1aa1('0x1d')]('inline',this),this[_0x1aa1('0x33')][_0x1aa1('0xe')]['set'](_0x1aa1('0x31'),(_0x371adb,_0x11c624)=>{const _0x3d25d0=this['_balloon'];if(this[_0x1aa1('0x2b')]&&_0x3d25d0[_0x1aa1('0x34')]){const _0x44e13b=this[_0x1aa1('0x4')][_0x1aa1('0x29')](_0x3d25d0[_0x1aa1('0x34')]);this[_0x1aa1('0x22')]['add'](_0x44e13b),this[_0x1aa1('0x1f')](_0x44e13b),_0x11c624();}}));}[_0x1aa1('0x3c')](){const _0x3aa2b6=this[_0x1aa1('0x33')][_0x1aa1('0x3')][_0x1aa1('0x35')](_0x3ddb93);_0x3aa2b6[_0x1aa1('0x39')]===this[_0x1aa1('0x33')]&&(_0x3aa2b6[_0x1aa1('0x0')]()||_0x3aa2b6[_0x1aa1('0x23')]('inline'));}[_0x1aa1('0x11')](_0x19a911){_0x19a911!==this[_0x1aa1('0x13')]&&(this[_0x1aa1('0x13')]&&(this[_0x1aa1('0x13')]['isActive']=!0x1),_0x19a911&&this[_0x1aa1('0x33')]['ui'][_0x1aa1('0x14')][_0x1aa1('0x2a')]&&(this[_0x1aa1('0x3b')](_0x19a911,!0x0),_0x19a911[_0x1aa1('0x15')]=!0x0),_0x19a911||this[_0x1aa1('0x26')]([]),this['activeAnnotation']=_0x19a911);}[_0x1aa1('0x27')](_0x523145){this[_0x1aa1('0x4')]=_0x523145;const _0x1e733d=this[_0x1aa1('0x33')][_0x1aa1('0x3')][_0x1aa1('0x35')](_0x3ddb93),_0x16a6b0=this[_0x1aa1('0x28')];if(this['isAttached'])throw new _0x359701(_0x1aa1('0xc'),this);if(_0x1e733d[_0x1aa1('0x39')]!==this[_0x1aa1('0x33')])throw new _0x359701(_0x1aa1('0x3a'),this);const _0xa2e466=this['editor']['plugins'][_0x1aa1('0x35')]('EditorAnnotations');this[_0x1aa1('0x2f')](_0xa2e466,_0x1aa1('0x38'),function(){const _0x330cbf=_0xa2e466['getOrderedSelectedAnnotations']({'activeAnnotation':this['activeAnnotation'],'annotations':this[_0x1aa1('0x4')]});this[_0x1aa1('0x26')](_0x330cbf),this['setActiveAnnotation'](_0x330cbf[0x0]||null);}[_0x1aa1('0x16')](this)),this['listenTo'](_0xa2e466,_0x1aa1('0x20'),(_0x14da7d,{isAnnotationTracked:_0xcde918})=>{this[_0x1aa1('0x13')]&&_0xcde918(this[_0x1aa1('0x13')])&&(this[_0x1aa1('0x26')]([]),this['setActiveAnnotation'](null));}),this[_0x1aa1('0x2f')](this[_0x1aa1('0x33')]['ui'][_0x1aa1('0x14')],'change:isFocused',(_0x363942,_0x7168de,_0x58f2d8)=>{_0x58f2d8||this[_0x1aa1('0x11')](null);}),this[_0x1aa1('0x2f')](_0x523145,'remove',(_0x47506c,_0x9cc996)=>{this[_0x1aa1('0x1f')](_0x9cc996),_0x9cc996===this[_0x1aa1('0x13')]&&this[_0x1aa1('0x11')](null);}),this[_0x1aa1('0x2f')](_0x16a6b0,_0x1aa1('0x37'),(_0x1bfeaf,_0x16eced,_0x544133,_0x4e3939)=>{if(_0x4e3939&&this['stopListening'](_0x4e3939),!_0x544133||!_0x523145['getByView'](_0x544133))return;const _0x506383=_0x523145[_0x1aa1('0x29')](_0x544133);this[_0x1aa1('0x2f')](_0x544133,'change:height',()=>{_0x16a6b0[_0x1aa1('0x17')]();}),this['listenTo'](_0x544133,'Esc',()=>{this[_0x1aa1('0x22')][_0x1aa1('0x25')](_0x506383),this[_0x1aa1('0x1f')](_0x506383),this[_0x1aa1('0x33')][_0x1aa1('0x12')]['view'][_0x1aa1('0x9')]();}),this['activeAnnotation']!==_0x506383&&this['setActiveAnnotation'](_0x506383);}),this[_0x1aa1('0x2f')](this[_0x1aa1('0x33')]['ui'],_0x1aa1('0x7'),()=>{_0x16a6b0[_0x1aa1('0x34')]&&(_0x523145['getByView'](_0x16a6b0[_0x1aa1('0x34')])&&_0x16a6b0[_0x1aa1('0x17')]());}),this['listenTo'](this[_0x1aa1('0x33')][_0x1aa1('0x12')][_0x1aa1('0x1b')][_0x1aa1('0x6')],_0x1aa1('0x2d'),()=>{this[_0x1aa1('0x22')]['clear']();}),this[_0x1aa1('0x33')][_0x1aa1('0x12')][_0x1aa1('0x1b')]['document'][_0x1aa1('0x19')]['editableElement']&&this[_0x1aa1('0x33')][_0x1aa1('0x12')][_0x1aa1('0x1b')][_0x1aa1('0x9')](),this[_0x1aa1('0x2b')]=!0x0;}[_0x1aa1('0x10')](){if(!this['isAttached'])throw new _0x359701('inlineannotations-detach-not-attached',this);this['setActiveAnnotation'](null);for(const _0x365e6b of this[_0x1aa1('0xa')])this[_0x1aa1('0x1f')](_0x365e6b);this[_0x1aa1('0x5')](),this[_0x1aa1('0x2b')]=!0x1;}[_0x1aa1('0x18')](){this['isAttached']&&this[_0x1aa1('0x10')]();}[_0x1aa1('0x26')](_0x2b0f3c){const _0x2ccfc6=this[_0x1aa1('0x21')];for(const _0x887737 of _0x2ccfc6)_0x2b0f3c[_0x1aa1('0x36')](_0x887737)||this['_manuallyClosed'][_0x1aa1('0x2c')](_0x887737);for(const _0xc1ef31 of this[_0x1aa1('0x4')])_0x2b0f3c[_0x1aa1('0x36')](_0xc1ef31)||this['_removeAnnotationFromBalloon'](_0xc1ef31);if(this[_0x1aa1('0x33')]['ui'][_0x1aa1('0x14')][_0x1aa1('0x2a')])for(const _0xa395cb of _0x2b0f3c)this[_0x1aa1('0x3b')](_0xa395cb);this[_0x1aa1('0x21')]=_0x2b0f3c;}['_addAnnotationToBalloon'](_0x4de5c5,_0x454de9){this[_0x1aa1('0x22')][_0x1aa1('0x2e')](_0x4de5c5)||(this[_0x1aa1('0xa')][_0x1aa1('0x2e')](_0x4de5c5)||this[_0x1aa1('0x28')][_0x1aa1('0x1c')](_0x4de5c5[_0x1aa1('0x1b')])||(this[_0x1aa1('0xa')][_0x1aa1('0x25')](_0x4de5c5),this[_0x1aa1('0x28')][_0x1aa1('0x25')]({'stackId':_0x4de5c5[_0x1aa1('0x1b')]['id'],'view':_0x4de5c5['view'],'position':{'target':()=>_0x4de5c5[_0x1aa1('0x2')]||_0x4de5c5[_0x1aa1('0xd')]||document[_0x1aa1('0xb')]()[_0x1aa1('0x1a')](0x0)}})),_0x454de9&&this[_0x1aa1('0x28')][_0x1aa1('0x30')](_0x4de5c5[_0x1aa1('0x1b')]['id']));}[_0x1aa1('0x1f')](_0x20a9ee){this[_0x1aa1('0xa')]['has'](_0x20a9ee)&&this['_balloon'][_0x1aa1('0x1c')](_0x20a9ee['view'])&&(this[_0x1aa1('0xa')][_0x1aa1('0x2c')](_0x20a9ee),this['_balloon'][_0x1aa1('0x8')](_0x20a9ee[_0x1aa1('0x1b')]));}}