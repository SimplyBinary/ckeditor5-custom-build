/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x4b59=['from','refreshVisibleViews','viewUid','destroy','_updateHasDirtyComment','createCollection','_rearrangeExpand','_handleRemoveCommentModel','element','some','_config','visibleViews','listenTo','length','_shouldCollapse','isActive','ck-thread__comments','equal','hasDirtyComment','change:isEditMode','set','_rearrangeCollapse','isEditMode','_collapsedCommentsView','comments','add','commentViews','formatDateTime','remove','expand','commentUpdated','focus','maxCommentCharsWhenCollapsed','count','render','insert','updateComment','removeComment','delete','stopListening','change:hasDirtyComment','_handleNewCommentModel'];(function(_0x4cde7c,_0x4b5941){const _0x229c0a=function(_0x309521){while(--_0x309521){_0x4cde7c['push'](_0x4cde7c['shift']());}};_0x229c0a(++_0x4b5941);}(_0x4b59,0x1a7));const _0x229c=function(_0x4cde7c,_0x4b5941){_0x4cde7c=_0x4cde7c-0x0;let _0x229c0a=_0x4b59[_0x4cde7c];return _0x229c0a;};import{View as _0x49ff2a}from'ckeditor5/src/ui';import{diff as _0x112b46,Collection as _0x5e293a}from'ckeditor5/src/utils';import _0x2a3ef9 from'./collapsedcommentsview';export default class L extends _0x49ff2a{constructor(_0x5438de,_0x91f125,_0x2479fe){super(_0x5438de),this['set'](_0x229c('0xf'),!0x1),this['set'](_0x229c('0xa'),_0x91f125[_0x229c('0x15')][_0x229c('0xa')]),this[_0x229c('0x11')](_0x229c('0xc'),!0x1),this['_model']=_0x91f125,this[_0x229c('0x7')]=_0x2479fe,this[_0x229c('0x17')]=this[_0x229c('0x2')](),this[_0x229c('0x8')]=this['createCollection'](),this[_0x229c('0x14')]=new _0x2a3ef9(_0x5438de),this[_0x229c('0x14')]['bind']('count')['to'](this,_0x229c('0xa'),_0xbc2dae=>_0xbc2dae-this[_0x229c('0x7')]['maxCommentsWhenCollapsed']);for(const _0x5b4ef5 of _0x91f125[_0x229c('0x15')])this[_0x229c('0x26')](_0x5b4ef5);this[_0x229c('0x9')](_0x91f125['comments'],_0x229c('0x16'),(_0xee5a27,_0x24d4db)=>{this[_0x229c('0xa')]++,this['_handleNewCommentModel'](_0x24d4db),this[_0x229c('0x28')]();}),this[_0x229c('0x9')](_0x91f125[_0x229c('0x15')],_0x229c('0x19'),(_0xb4910b,_0x3e3a2d)=>{this[_0x229c('0xa')]--,this['_handleRemoveCommentModel'](_0x3e3a2d),this['refreshVisibleViews']();}),this['listenTo'](_0x91f125,_0x229c('0x1b'),()=>this[_0x229c('0x28')]()),this['on']('change:isActive',()=>this[_0x229c('0x28')]()),this['on'](_0x229c('0x25'),()=>this[_0x229c('0x28')]()),this['setTemplate']({'tag':'ul','attributes':{'class':[_0x229c('0xd')]},'children':this[_0x229c('0x8')]});}get['_shouldCollapse'](){return this['_model']['weight']>this['_config']['maxThreadTotalWeight']&&!this[_0x229c('0xc')]&&!this['hasDirtyComment'];}['render'](){super[_0x229c('0x1f')](),this[_0x229c('0x28')]();}[_0x229c('0x1c')](){this[_0x229c('0x5')][_0x229c('0x1c')]();}[_0x229c('0x0')](){this['_collapsedCommentsView'][_0x229c('0x0')]();for(const _0x9ec08c of this[_0x229c('0x17')])_0x9ec08c[_0x229c('0x0')]();super['destroy']();}[_0x229c('0x28')](){this[_0x229c('0xb')]?this['_rearrangeCollapse']():this[_0x229c('0x3')]();}['_handleNewCommentModel'](_0x29ce2a){const _0xc99503=new this[(_0x229c('0x7'))]['CommentView'](this['locale'],_0x29ce2a,{'maxCommentCharsWhenCollapsed':this['_config'][_0x229c('0x1d')],'formatDateTime':this[_0x229c('0x7')][_0x229c('0x18')],'editorConfig':this[_0x229c('0x7')]['editorConfig']});_0xc99503[_0x229c('0x29')]=_0x29ce2a['id'],_0xc99503['delegate'](_0x229c('0x22'))['to'](this),_0xc99503['delegate'](_0x229c('0x21'))['to'](this),this['listenTo'](_0xc99503,_0x229c('0x10'),()=>this['_updateHasDirtyComment']()),this[_0x229c('0x17')][_0x229c('0x16')](_0xc99503);}[_0x229c('0x4')](_0x4c5f37){const _0x18e6e5=this[_0x229c('0x17')][_0x229c('0x19')](_0x4c5f37['id']);this[_0x229c('0x24')](_0x18e6e5),_0x18e6e5['isEditMode']&&this[_0x229c('0x1')](),_0x18e6e5[_0x229c('0x0')]();}[_0x229c('0x1')](){this[_0x229c('0xf')]=Array[_0x229c('0x27')](this['commentViews'])[_0x229c('0x6')](_0x23475c=>_0x23475c[_0x229c('0x13')]);}[_0x229c('0x12')](){const _0x157708=function(_0x105662){const _0x174a4c=new _0x5e293a();for(const _0x452fe6 of _0x105662)_0x174a4c[_0x229c('0x16')](_0x452fe6);return _0x174a4c;}(this[_0x229c('0x17')]),_0x1c2340=this[_0x229c('0x14')][_0x229c('0x1e')];for(let _0x19c22e=0x1;_0x19c22e<=_0x1c2340;_0x19c22e++)_0x157708['remove'](0x1);for(const _0x1d3af2 of _0x157708)_0x1d3af2['collapse']();_0x1c2340>0x0&&_0x157708['add'](this[_0x229c('0x14')],0x1),Ut(_0x112b46(Array['from'](this['visibleViews']),Array['from'](_0x157708)),this['visibleViews'],_0x157708);}['_rearrangeExpand'](){Ut(_0x112b46(Array[_0x229c('0x27')](this['visibleViews']),Array[_0x229c('0x27')](this['commentViews'])),this[_0x229c('0x8')],this[_0x229c('0x17')]);for(const _0x416b8a of this[_0x229c('0x8')])_0x416b8a[_0x229c('0x1a')]();}}function Ut(_0x57d874,_0x2ddecf,_0x765b31){let _0xaaef07=0x0;for(const _0x3b21e6 of _0x57d874)switch(_0x3b21e6){case _0x229c('0x20'):_0x2ddecf[_0x229c('0x16')](_0x765b31['get'](_0xaaef07),_0xaaef07),_0xaaef07++;break;case _0x229c('0x23'):_0x2ddecf[_0x229c('0x19')](_0xaaef07);break;case _0x229c('0xe'):_0xaaef07++;}}