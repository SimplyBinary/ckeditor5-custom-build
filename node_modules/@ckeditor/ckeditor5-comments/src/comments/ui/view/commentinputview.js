/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{View as ht,ViewCollection as Bt,FocusCycler as St,ButtonView as mt}from'ckeditor5/src/ui';import{FocusTracker as _0x2949e4,KeystrokeHandler as pt}from'ckeditor5/src/utils';import{icons as Gt}from'ckeditor5/src/core';import qt from'../commenteditor/commenteditor';export default class Tt extends ht{constructor(_0x374a64,_0x3bf09a={}){super(_0x374a64);const {t:t}=_0x374a64;this['editor']=new qt(_0x3bf09a),this['keystrokes']=new pt(),this['focusTracker']=new _0x2949e4(),this['set']('value',_0x3bf09a['initialData']||''),this['set']('disabledSubmit',!0x1),this['set']('showButtons',!0x0),this['set']('placeholder',t('Reply...')),this['submitButtonView']=this['_createSubmitButton'](),this['cancelButtonView']=this['_createCancelButton'](),this['setTemplate']({'tag':'div','attributes':{'class':['ck-comment__input-wrapper']},'children':[{'tag':'div','attributes':{'class':['ck-comment__input-actions',this['bindTemplate']['if']('showButtons','ck-comment__input-actions--active')]},'children':[this['submitButtonView'],this['cancelButtonView']]}]}),this['keystrokes']['set']('Esc',(_0xdffdb6,_0x2e24ba)=>{this['cancelButtonView']['fire']('execute'),_0x2e24ba();}),this['on']('submit',(_0x36c186,_0x31b09d)=>{_0x31b09d['length']>0xfde8?(alert(t({'string':'Comment\x20content\x20is\x20too\x20long.\x20Your\x20comment\x20has\x20%0\x20characters\x20but\x20the\x20limit\x20is\x20%1\x20characters.','id':'TOO_LONG_COMMENT_ALERT'},[_0x31b09d['length'],0xfde8])),_0x36c186['stop']()):this['editor']['setData']('');},{'priority':'high'});}['render'](){super['render']();const {editor:_0x26baba,element:_0x46854d}=this;this['keystrokes']['listenTo'](_0x46854d),this['focusTracker']['add'](_0x46854d),this['_editorCreationPromise']=_0x26baba['create']()['then'](()=>{_0x46854d['insertBefore'](_0x26baba['ui']['element'],_0x46854d['firstChild']),_0x26baba['model']['document']['on']('change',()=>this['value']=_0x26baba['getData']()),_0x26baba['bind']('placeholder')['to'](this),this['_initializeFocusCycling'](_0x26baba),this['fire']('editorReady');});}['focus'](){this['editor']['focus']();}async['destroy'](){this['_isDestroyed']||(this['_isDestroyed']=!0x0,this['isRendered']&&(await this['_editorCreationPromise'],await this['editor']['destroy']()),await super['destroy']());}['_createSubmitButton'](){const _0x297ab9=new mt(this['locale']),{t:t}=this['locale'];return _0x297ab9['extendTemplate']({'attributes':{'class':['ck-comment__input-actions--submit']}}),_0x297ab9['label']=t('Submit'),_0x297ab9['icon']=Gt['check'],_0x297ab9['on']('execute',()=>{this['fire']('submit',this['value']);}),_0x297ab9['bind']('isEnabled')['to'](this,'value',this,'disabledSubmit',(_0x54e110,_0x2e044d)=>!_0x2e044d&&!!_0x54e110['trim']()),_0x297ab9;}['_createCancelButton'](){const _0x3ab44f=new mt(this['locale']),{t:t}=this['locale'];return _0x3ab44f['extendTemplate']({'attributes':{'class':['ck-comment__input-actions--cancel']}}),_0x3ab44f['label']=t('Cancel'),_0x3ab44f['icon']=Gt['cancel'],_0x3ab44f['on']('execute',()=>{this['editor']['setData'](''),this['fire']('cancel');}),_0x3ab44f;}['_initializeFocusCycling'](_0x18fa72){const _0x48aeff=this['focusTracker'],_0x1319a3=new Bt();[_0x18fa72['ui']['view'],this['submitButtonView'],this['cancelButtonView']]['forEach'](_0x5b853e=>{_0x1319a3['add'](_0x5b853e),_0x48aeff['add'](_0x5b853e['element']);});const _0x423243=new St({'focusables':_0x1319a3,'focusTracker':_0x48aeff});this['keystrokes']['set']('tab',(_0x1016fb,_0x17f9b8)=>{_0x423243['focusNext'](),_0x17f9b8();},{'priority':'low'}),this['keystrokes']['set']('shift\x20+\x20tab',(_0x298536,_0x1aff3b)=>{_0x423243['focusPrevious'](),_0x1aff3b();},{'priority':'low'});}}