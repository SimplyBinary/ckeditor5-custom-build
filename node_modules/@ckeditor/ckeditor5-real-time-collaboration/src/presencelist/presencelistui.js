/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x10a5=['destroy','counterView','presenceList','get','items','_handleUserAdd','plugins','appendChild','config','inlineListView','isRendered','unpin','pin','isVisible','element','remove','hideDropdown','isHidden','from','presencelist-missing-container','detachFromDom','bindTo','_createView','lastConnectedUsers','presenceDropdownView','locale','showDropdown','listenTo','usersCount','class','presencelist-collapseat-invalid-format','using','length','context','bodyCollection','presenceList.container','define','reverse','balloonPanelView','add','requires','view','render','number','onClick','content','allConnectedUsers','init','presenceList.collapseAt','_allConnectedUsers','isCollapsed','attachToDom','execute'];(function(_0xb1127e,_0x10a5fa){const _0x3f5147=function(_0x51797e){while(--_0x51797e){_0xb1127e['push'](_0xb1127e['shift']());}};_0x3f5147(++_0x10a5fa);}(_0x10a5,0x92));const _0x3f51=function(_0xb1127e,_0x10a5fa){_0xb1127e=_0xb1127e-0x0;let _0x3f5147=_0x10a5[_0xb1127e];return _0x3f5147;};import{ContextPlugin as _0x3afdfb}from'ckeditor5/src/core';import{CKEditorError as _0x3f2d56,Collection as _0xd9a9b2}from'ckeditor5/src/utils';import{clickOutsideHandler as _0x597b81,BodyCollection as _0x20695f,BalloonPanelView as _0x38e059}from'ckeditor5/src/ui';import{isElement as _0x5e799d}from'lodash-es';import _0x35f70d from'../realtimecollaborativeediting/sessions';import _0x18ba3e from'./view/presencelistview';import _0x5efcc3 from'./view/presencedropdownlistview';import _0x530769 from'./view/presencedropdownlistitemview';import _0x2c5f45 from'./view/presenceinlinelistitemview';export default class i extends _0x3afdfb{constructor(_0x5ad1bc){super(_0x5ad1bc),_0x5ad1bc['config'][_0x3f51('0x31')](_0x3f51('0xf'),{'collapseAt':0x6});const _0x3f24e7=_0x5ad1bc[_0x3f51('0x15')][_0x3f51('0x10')](_0x3f51('0x8'));if(_0x3f51('0x3')!=typeof _0x3f24e7)throw new _0x3f2d56(_0x3f51('0x2b'),this);if(_0x3f24e7<0x1)throw new _0x3f2d56('presencelist-collapseat-invalid-format',this);}static get[_0x3f51('0x0')](){return[_0x35f70d];}[_0x3f51('0x7')](){const _0x504f5c=this[_0x3f51('0x2e')];this['_allConnectedUsers']=_0x504f5c[_0x3f51('0x13')][_0x3f51('0x10')](_0x35f70d)[_0x3f51('0x6')],this['set'](_0x3f51('0x29'),0x0),this[_0x3f51('0x24')]=new _0xd9a9b2(),this[_0x3f51('0x33')]=new _0x38e059(),this[_0x3f51('0x33')][_0x3f51('0x2a')]='ck\x20ck-presence-list__balloon',this[_0x3f51('0x1')]=this[_0x3f51('0x23')](),this[_0x3f51('0x25')]=void 0x0;for(const _0x278aec of this['_allConnectedUsers'])this[_0x3f51('0x12')](_0x278aec);this[_0x3f51('0x28')](this[_0x3f51('0x9')],'add',(_0x537450,_0x1b56fa)=>{this[_0x3f51('0x12')](_0x1b56fa);}),this[_0x3f51('0x28')](this[_0x3f51('0x9')],_0x3f51('0x1c'),(_0x1553cb,_0xaa9842)=>{this['_handleUserRemove'](_0xaa9842);});}[_0x3f51('0x23')](){const _0xd8c179=this[_0x3f51('0x2e')],_0x8af9ef=new _0x18ba3e(this[_0x3f51('0x2e')][_0x3f51('0x26')]),_0x53e87c=this['balloonPanelView'];if(!_0x5e799d(_0xd8c179[_0x3f51('0x15')][_0x3f51('0x10')](_0x3f51('0x30'))))throw new _0x3f2d56(_0x3f51('0x20'),this);return _0x8af9ef[_0x3f51('0xe')]['bind']('usersCount')['to'](this),_0x8af9ef['bind']('isCollapsed')['to'](this,_0x3f51('0x29'),_0x1313f=>{const _0x321699=_0x1313f>=_0xd8c179[_0x3f51('0x15')]['get']('presenceList.collapseAt');return _0x8af9ef['counterView'][_0x3f51('0x1e')]=!(0x1==_0x1313f||_0x321699),_0x321699||this[_0x3f51('0x1d')](),_0x321699;}),_0x8af9ef[_0x3f51('0x16')][_0x3f51('0x11')][_0x3f51('0x22')](this['lastConnectedUsers'])[_0x3f51('0x2c')](_0x3996cf=>{const _0x1df42e=_0xd8c179['config'][_0x3f51('0x10')](_0x3f51('0xf')),_0x3f6224=new _0x2c5f45(_0xd8c179[_0x3f51('0x26')],_0x3996cf,_0x1df42e[_0x3f51('0x4')]);return _0x1df42e[_0x3f51('0x4')]&&this[_0x3f51('0x28')](_0x3f6224,'execute',()=>{this[_0x3f51('0x1')][_0x3f51('0xa')]||_0x1df42e[_0x3f51('0x4')](_0x3996cf,_0x3f6224[_0x3f51('0x1b')]);}),_0x3f6224;}),this[_0x3f51('0x28')](_0x8af9ef[_0x3f51('0x16')],_0x3f51('0xc'),()=>{this[_0x3f51('0x25')]?this['hideDropdown']():this[_0x3f51('0x1')][_0x3f51('0xa')]&&this[_0x3f51('0x27')]();}),_0x8af9ef['render'](),_0x53e87c[_0x3f51('0x2')](),_0x597b81({'emitter':_0x8af9ef,'activator':()=>_0x53e87c[_0x3f51('0x1a')],'contextElements':[_0x53e87c[_0x3f51('0x1b')],_0x8af9ef[_0x3f51('0x16')][_0x3f51('0x1b')]],'callback':()=>this[_0x3f51('0x1d')]()}),_0xd8c179[_0x3f51('0x15')]['get'](_0x3f51('0x30'))[_0x3f51('0x14')](_0x8af9ef['element']),this[_0x3f51('0x2f')]=new _0x20695f(this[_0x3f51('0x2e')][_0x3f51('0x26')]),this[_0x3f51('0x2f')][_0x3f51('0xb')](),this[_0x3f51('0x2f')][_0x3f51('0x34')](_0x53e87c),_0x8af9ef;}[_0x3f51('0x12')](_0x391f44){this[_0x3f51('0x29')]++,0x5==this['lastConnectedUsers'][_0x3f51('0x2d')]&&this[_0x3f51('0x24')][_0x3f51('0x1c')](0x0),this[_0x3f51('0x24')][_0x3f51('0x34')](_0x391f44);}['_handleUserRemove'](_0x5e8b88){if(this[_0x3f51('0x29')]--,this['lastConnectedUsers'][_0x3f51('0x10')](_0x5e8b88['id'])&&(this[_0x3f51('0x24')][_0x3f51('0x1c')](_0x5e8b88['id']),this['lastConnectedUsers'][_0x3f51('0x2d')]<this[_0x3f51('0x29')]))for(const _0x4ee214 of Array[_0x3f51('0x1f')](this[_0x3f51('0x9')])[_0x3f51('0x32')]())if(!this[_0x3f51('0x24')]['get'](_0x4ee214['id']))return void this[_0x3f51('0x24')][_0x3f51('0x34')](_0x4ee214,0x0);}[_0x3f51('0x27')](){if(this[_0x3f51('0x25')])return;this[_0x3f51('0x25')]=new _0x5efcc3();const _0x26785b=this['context'][_0x3f51('0x15')][_0x3f51('0x10')](_0x3f51('0xf'));this[_0x3f51('0x25')][_0x3f51('0x11')][_0x3f51('0x22')](this[_0x3f51('0x9')])[_0x3f51('0x2c')](_0xf1f91e=>{const _0x20a153=new _0x530769(this[_0x3f51('0x2e')][_0x3f51('0x26')],_0xf1f91e,!!_0x26785b[_0x3f51('0x4')]);return _0x26785b[_0x3f51('0x4')]&&this[_0x3f51('0x28')](_0x20a153,_0x3f51('0xc'),()=>{_0x26785b[_0x3f51('0x4')](_0xf1f91e,_0x20a153['element']);}),_0x20a153;}),this[_0x3f51('0x33')][_0x3f51('0x5')][_0x3f51('0x34')](this[_0x3f51('0x25')]),this[_0x3f51('0x33')][_0x3f51('0x19')]({'target':this[_0x3f51('0x1')]['inlineListView'][_0x3f51('0x1b')]});}[_0x3f51('0x1d')](){this[_0x3f51('0x25')]&&(this['balloonPanelView'][_0x3f51('0x18')](),this['balloonPanelView'][_0x3f51('0x5')]['remove'](this[_0x3f51('0x25')]),this[_0x3f51('0x25')][_0x3f51('0xd')](),this['presenceDropdownView']=void 0x0);}[_0x3f51('0xd')](){super['destroy'](),this[_0x3f51('0x1')]&&this['view'][_0x3f51('0x17')]&&this['view'][_0x3f51('0xd')](),this[_0x3f51('0x2f')]&&this[_0x3f51('0x2f')][_0x3f51('0x21')]();}}