/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x22f4=['render','_handleUserRemove','inlineListView','_createView','bindTo','set','element','unpin','isRendered','add','get','presencelist-collapseat-invalid-format','bodyCollection','hideDropdown','lastConnectedUsers','execute','define','config','presenceDropdownView','listenTo','showDropdown','usersCount','init','isHidden','items','ck\x20ck-presence-list__balloon','presenceList','_handleUserAdd','destroy','isCollapsed','counterView','_allConnectedUsers','locale','presenceList.container','reverse','appendChild','balloonPanelView','presenceList.collapseAt','content','onClick','length','view','plugins','presencelist-missing-container','context','number','using','remove','allConnectedUsers'];(function(_0x143b85,_0x22f40b){const _0x4cd0ce=function(_0xead053){while(--_0xead053){_0x143b85['push'](_0x143b85['shift']());}};_0x4cd0ce(++_0x22f40b);}(_0x22f4,0xb9));const _0x4cd0=function(_0x143b85,_0x22f40b){_0x143b85=_0x143b85-0x0;let _0x4cd0ce=_0x22f4[_0x143b85];return _0x4cd0ce;};import{ContextPlugin as _0x5be53a}from'ckeditor5/src/core';import{CKEditorError as _0x1306c9,Collection as _0x3c378a}from'ckeditor5/src/utils';import{clickOutsideHandler as _0x827da3,BodyCollection as _0x5b3d4d,BalloonPanelView as _0x4f0886}from'ckeditor5/src/ui';import{isElement as _0x20de66}from'lodash-es';import _0x1914ce from'../realtimecollaborativeediting/sessions';import _0x4967af from'./view/presencelistview';import _0x1bf0d2 from'./view/presencedropdownlistview';import _0x492e41 from'./view/presencedropdownlistitemview';import _0x475cc0 from'./view/presenceinlinelistitemview';export default class i extends _0x5be53a{constructor(_0x3864c9){super(_0x3864c9),_0x3864c9[_0x4cd0('0x1c')][_0x4cd0('0x1b')](_0x4cd0('0x25'),{'collapseAt':0x6});const _0x449c3d=_0x3864c9[_0x4cd0('0x1c')][_0x4cd0('0x15')](_0x4cd0('0x30'));if(_0x4cd0('0x7')!=typeof _0x449c3d)throw new _0x1306c9(_0x4cd0('0x16'),this);if(_0x449c3d<0x1)throw new _0x1306c9('presencelist-collapseat-invalid-format',this);}static get['requires'](){return[_0x1914ce];}[_0x4cd0('0x21')](){const _0x335982=this[_0x4cd0('0x6')];this['_allConnectedUsers']=_0x335982[_0x4cd0('0x4')][_0x4cd0('0x15')](_0x1914ce)[_0x4cd0('0xa')],this[_0x4cd0('0x10')](_0x4cd0('0x20'),0x0),this[_0x4cd0('0x19')]=new _0x3c378a(),this['balloonPanelView']=new _0x4f0886(),this[_0x4cd0('0x2f')]['class']=_0x4cd0('0x24'),this[_0x4cd0('0x3')]=this['_createView'](),this[_0x4cd0('0x1d')]=void 0x0;for(const _0x242be8 of this['_allConnectedUsers'])this[_0x4cd0('0x26')](_0x242be8);this['listenTo'](this[_0x4cd0('0x2a')],_0x4cd0('0x14'),(_0x1d3c67,_0x800be3)=>{this[_0x4cd0('0x26')](_0x800be3);}),this[_0x4cd0('0x1e')](this[_0x4cd0('0x2a')],_0x4cd0('0x9'),(_0x177555,_0x89352f)=>{this[_0x4cd0('0xc')](_0x89352f);});}[_0x4cd0('0xe')](){const _0x364660=this[_0x4cd0('0x6')],_0x446d13=new _0x4967af(this['context'][_0x4cd0('0x2b')]),_0x18ce4c=this[_0x4cd0('0x2f')];if(!_0x20de66(_0x364660[_0x4cd0('0x1c')][_0x4cd0('0x15')](_0x4cd0('0x2c'))))throw new _0x1306c9(_0x4cd0('0x5'),this);return _0x446d13['counterView']['bind']('usersCount')['to'](this),_0x446d13['bind'](_0x4cd0('0x28'))['to'](this,_0x4cd0('0x20'),_0x4d8e5d=>{const _0x4196a2=_0x4d8e5d>=_0x364660['config'][_0x4cd0('0x15')]('presenceList.collapseAt');return _0x446d13[_0x4cd0('0x29')][_0x4cd0('0x22')]=!(0x1==_0x4d8e5d||_0x4196a2),_0x4196a2||this[_0x4cd0('0x18')](),_0x4196a2;}),_0x446d13['inlineListView'][_0x4cd0('0x23')]['bindTo'](this['lastConnectedUsers'])[_0x4cd0('0x8')](_0x1dddd8=>{const _0x223b11=_0x364660['config'][_0x4cd0('0x15')]('presenceList'),_0x212dcf=new _0x475cc0(_0x364660[_0x4cd0('0x2b')],_0x1dddd8,_0x223b11[_0x4cd0('0x1')]);return _0x223b11[_0x4cd0('0x1')]&&this[_0x4cd0('0x1e')](_0x212dcf,_0x4cd0('0x1a'),()=>{this[_0x4cd0('0x3')][_0x4cd0('0x28')]||_0x223b11[_0x4cd0('0x1')](_0x1dddd8,_0x212dcf['element']);}),_0x212dcf;}),this[_0x4cd0('0x1e')](_0x446d13[_0x4cd0('0xd')],_0x4cd0('0x1a'),()=>{this[_0x4cd0('0x1d')]?this[_0x4cd0('0x18')]():this[_0x4cd0('0x3')][_0x4cd0('0x28')]&&this[_0x4cd0('0x1f')]();}),_0x446d13[_0x4cd0('0xb')](),_0x18ce4c['render'](),_0x827da3({'emitter':_0x446d13,'activator':()=>_0x18ce4c['isVisible'],'contextElements':[_0x18ce4c['element'],_0x446d13[_0x4cd0('0xd')][_0x4cd0('0x11')]],'callback':()=>this['hideDropdown']()}),_0x364660[_0x4cd0('0x1c')][_0x4cd0('0x15')](_0x4cd0('0x2c'))[_0x4cd0('0x2e')](_0x446d13[_0x4cd0('0x11')]),this['bodyCollection']=new _0x5b3d4d(this[_0x4cd0('0x6')]['locale']),this['bodyCollection']['attachToDom'](),this[_0x4cd0('0x17')][_0x4cd0('0x14')](_0x18ce4c),_0x446d13;}['_handleUserAdd'](_0x55c87c){this[_0x4cd0('0x20')]++,0x5==this[_0x4cd0('0x19')]['length']&&this[_0x4cd0('0x19')][_0x4cd0('0x9')](0x0),this['lastConnectedUsers']['add'](_0x55c87c);}['_handleUserRemove'](_0x4a0d18){if(this[_0x4cd0('0x20')]--,this[_0x4cd0('0x19')]['get'](_0x4a0d18['id'])&&(this[_0x4cd0('0x19')][_0x4cd0('0x9')](_0x4a0d18['id']),this[_0x4cd0('0x19')][_0x4cd0('0x2')]<this['usersCount']))for(const _0x12190d of Array['from'](this[_0x4cd0('0x2a')])[_0x4cd0('0x2d')]())if(!this[_0x4cd0('0x19')][_0x4cd0('0x15')](_0x12190d['id']))return void this[_0x4cd0('0x19')][_0x4cd0('0x14')](_0x12190d,0x0);}[_0x4cd0('0x1f')](){if(this['presenceDropdownView'])return;this[_0x4cd0('0x1d')]=new _0x1bf0d2();const _0x4bec06=this[_0x4cd0('0x6')]['config'][_0x4cd0('0x15')]('presenceList');this['presenceDropdownView']['items'][_0x4cd0('0xf')](this[_0x4cd0('0x2a')])['using'](_0x53c627=>{const _0x37b7ba=new _0x492e41(this['context'][_0x4cd0('0x2b')],_0x53c627,!!_0x4bec06[_0x4cd0('0x1')]);return _0x4bec06['onClick']&&this[_0x4cd0('0x1e')](_0x37b7ba,'execute',()=>{_0x4bec06['onClick'](_0x53c627,_0x37b7ba[_0x4cd0('0x11')]);}),_0x37b7ba;}),this[_0x4cd0('0x2f')][_0x4cd0('0x0')][_0x4cd0('0x14')](this[_0x4cd0('0x1d')]),this[_0x4cd0('0x2f')]['pin']({'target':this[_0x4cd0('0x3')][_0x4cd0('0xd')][_0x4cd0('0x11')]});}[_0x4cd0('0x18')](){this['presenceDropdownView']&&(this['balloonPanelView'][_0x4cd0('0x12')](),this[_0x4cd0('0x2f')][_0x4cd0('0x0')]['remove'](this[_0x4cd0('0x1d')]),this[_0x4cd0('0x1d')][_0x4cd0('0x27')](),this[_0x4cd0('0x1d')]=void 0x0);}['destroy'](){super[_0x4cd0('0x27')](),this[_0x4cd0('0x3')]&&this[_0x4cd0('0x3')][_0x4cd0('0x13')]&&this[_0x4cd0('0x3')][_0x4cd0('0x27')](),this[_0x4cd0('0x17')]&&this[_0x4cd0('0x17')]['detachFromDom']();}}