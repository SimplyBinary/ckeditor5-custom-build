/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3904=['markerRange','orderNumber','clear','toDomElement','removeMarker','newRange','delete','ck-user__marker\x20','batch','updateMarker','end','user:range','mySessionId','update:user:range','addMarker','root','hasContent','getPositions','requires','data-session-id','setCustomProperty','$text','oldRange','getFirstRange','document','set','afterInit','view','editing','markerToElement','isCollapsed','for','markerName','isSimilar','getRange','user:range:','user:position:','markerToHighlight','commands','selection','createRange','enqueueChange','get','editor','deletionPosition','name','schema','reconvertMarker','user:position','getSelectionClass','change:range','color','model','start','size','render','rootName','contenteditable','tableCell','highest','getAttribute','parent','getUserBySessionId','conversion','change','getContainedElement','editingDowncast','markers','userPositionMarker','checkChild','isInline','toRange','isObject','plugins','startsWith','has','isLimit','split','priority','createUIElement','fromRange','$graveyard','detach','nodeAfter','undo','getCustomProperty','user:','init','pluginName'];(function(_0x14d1b7,_0x390408){const _0x315af0=function(_0x21245d){while(--_0x21245d){_0x14d1b7['push'](_0x14d1b7['shift']());}};_0x315af0(++_0x390408);}(_0x3904,0xbb));const _0x315a=function(_0x14d1b7,_0x390408){_0x14d1b7=_0x14d1b7-0x0;let _0x315af0=_0x3904[_0x14d1b7];return _0x315af0;};import{Plugin as _0x4d30b0}from'ckeditor5/src/core';import _0x175c00 from'./sessions';import{LiveRange as _0x63f34d}from'ckeditor5/src/engine';import'../../theme/usermarkers.css';export default class G extends _0x4d30b0{static get[_0x315a('0x9')](){return[_0x175c00];}static get[_0x315a('0x4f')](){return'UserMarkers';}[_0x315a('0x4e')](){const _0x11ef04=this[_0x315a('0x22')],_0x10e4af=_0x11ef04['plugins']['get'](_0x175c00);_0x11ef04[_0x315a('0x36')]['for'](_0x315a('0x39'))[_0x315a('0x14')]({'model':_0x315a('0x27'),'view':(_0x3b9a15,{writer:_0x4c7fea})=>function(_0x1e3c9b,_0x507617,_0x16be3a,_0x47570f){const _0x19471c=_0x1e3c9b[_0x315a('0x17')][_0x315a('0x44')](':')[0x2],_0x4c506d=_0x16be3a[_0x315a('0x35')](_0x19471c);if(!_0x4c506d||_0x19471c===_0x16be3a['mySessionId'])return;if(!_0x47570f[_0x315a('0x2b')][_0x315a('0x25')]['checkChild'](_0x1e3c9b[_0x315a('0x50')][_0x315a('0x2c')],_0x315a('0xc')))return;const _0x30c8e0={'class':_0x315a('0x57')+_0x4c506d[_0x315a('0x2a')]['getMarkerClass'](),'data-name':_0x4c506d[_0x315a('0x24')],'data-session-id':_0x19471c},_0x1e946c=_0x47570f[_0x315a('0x2b')][_0x315a('0x3a')][_0x315a('0x21')](_0x1e3c9b[_0x315a('0x17')])['getStart'](),_0x306950=_0x1e946c[_0x315a('0x4a')],_0x1ae2d0=_0x47570f[_0x315a('0x2b')][_0x315a('0x25')];if(_0x306950&&_0x1ae2d0[_0x315a('0x3f')](_0x306950)&&_0x1ae2d0[_0x315a('0x3d')](_0x306950)&&!_0x47570f['model']['markers'][_0x315a('0x21')](_0x315a('0x1a')+_0x19471c)['getRange']()[_0x315a('0x15')])return;const _0x1417a4=_0x1e946c[_0x315a('0x34')];_0x47570f[_0x315a('0x2b')]['schema'][_0x315a('0x43')](_0x1417a4)&&!_0x47570f[_0x315a('0x2b')][_0x315a('0x7')](_0x1417a4)&&(_0x30c8e0[_0x315a('0x30')]=!0x1);const _0x309f3f=function(_0x309d37,_0xe60874){const _0x1184b9=_0x309d37[_0x315a('0x46')]('span',_0xe60874);return _0x309d37[_0x315a('0xb')](_0x315a('0x3b'),!0x0,_0x1184b9),_0x1184b9[_0x315a('0x2e')]=function(_0x108886){const _0x592761=this[_0x315a('0x53')](_0x108886);return _0x592761['innerHTML']='&#8203;<span\x20class=\x22ck-user__marker-line\x22><span\x20class=\x22ck-user__marker-dot\x22></span></span>',_0x592761;},_0x1184b9[_0x315a('0x18')]=function(_0x20950f){return this[_0x315a('0x4c')](_0x315a('0x3b'))&&_0x20950f[_0x315a('0x4c')](_0x315a('0x3b'))&&this['getAttribute'](_0x315a('0xa'))==_0x20950f[_0x315a('0x33')]('data-session-id');},_0x1184b9;}(_0x507617,_0x30c8e0);return _0x309f3f[_0x315a('0x45')]=0x3e8+_0x4c506d[_0x315a('0x51')],_0x309f3f;}(_0x3b9a15,_0x4c7fea,_0x10e4af,_0x11ef04)}),_0x11ef04[_0x315a('0x36')][_0x315a('0x16')](_0x315a('0x39'))[_0x315a('0x1c')]({'model':_0x315a('0x2'),'view':_0x25012c=>function(_0x4983e7,_0x41480c){const _0xeee80=_0x4983e7['markerName'][_0x315a('0x44')](':')[0x2];if(_0xeee80===_0x41480c[_0x315a('0x3')])return;const _0x1ca7fb=_0x41480c[_0x315a('0x35')](_0xeee80);if(!_0x1ca7fb)return{'id':_0xeee80};return{'id':_0xeee80,'classes':['ck-user__selection',_0x1ca7fb[_0x315a('0x2a')][_0x315a('0x28')]()],'attributes':{'data-session-id':_0xeee80},'priority':0x7d0+_0x1ca7fb[_0x315a('0x51')]};}(_0x25012c,_0x10e4af)}),function(_0x43ea44){const _0x11f354=_0x43ea44[_0x315a('0x2b')],_0x332f91=new Map(),_0x45f025=_0x43ea44[_0x315a('0x40')][_0x315a('0x21')](_0x175c00);_0x11f354[_0x315a('0x3a')]['on'](_0x315a('0x4'),(_0x7adad2,_0x75b52c,_0x26fda3,_0x2979fb)=>{if(!_0x2979fb&&_0x332f91[_0x315a('0x21')](_0x75b52c[_0x315a('0x24')]))return _0x332f91[_0x315a('0x21')](_0x75b52c['name'])[_0x315a('0x49')](),void _0x332f91[_0x315a('0x56')](_0x75b52c[_0x315a('0x24')]);const _0x53d09a=_0x75b52c[_0x315a('0x24')][_0x315a('0x44')](':')[0x2];if(_0x53d09a===_0x45f025[_0x315a('0x3')])return;const _0x423d0f=_0x315a('0x1b')+_0x53d09a;_0x11f354[_0x315a('0x3a')][_0x315a('0x42')](_0x423d0f)&&_0x43ea44[_0x315a('0x13')][_0x315a('0x26')](_0x423d0f),_0x75b52c['on'](_0x315a('0x29'),(_0x47f839,_0x2f7730,_0x53c087)=>{if(_0x315a('0x48')!=_0x2f7730['root'][_0x315a('0x2f')]&&_0x315a('0x48')==_0x75b52c['getRange']()[_0x315a('0x6')][_0x315a('0x2f')]&&!_0x332f91['has'](_0x75b52c[_0x315a('0x24')])){const _0x176d03=_0x11f354[_0x315a('0x25')]['getNearestSelectionRange'](_0x53c087[_0x315a('0x23')]);if(_0x176d03){const _0x252cdb=_0x63f34d[_0x315a('0x47')](_0x176d03);_0x332f91[_0x315a('0x10')](_0x75b52c[_0x315a('0x24')],_0x252cdb),_0x252cdb['on']('change:range',(_0x323216,_0x3e56df,_0x48ba37)=>{if(_0x315a('0x48')==_0x252cdb[_0x315a('0x6')][_0x315a('0x2f')]){const _0x4f5018=_0x11f354[_0x315a('0x25')]['getNearestSelectionRange'](_0x48ba37[_0x315a('0x23')]);_0x4f5018?(_0x252cdb['start']=_0x4f5018[_0x315a('0x2c')],_0x252cdb[_0x315a('0x1')]=_0x4f5018[_0x315a('0x1')]):(_0x332f91['delete'](_0x75b52c[_0x315a('0x24')]),_0x252cdb[_0x315a('0x49')]());}});}}});}),_0x11f354[_0x315a('0xf')]['on'](_0x315a('0x37'),()=>{_0x332f91[_0x315a('0x2d')]>0x0&&_0x11f354['enqueueChange']({'isUndoable':!0x1},_0x5ca344=>{for(const [_0x4e5017,_0x406a1c]of _0x332f91)'$graveyard'==_0x11f354['markers'][_0x315a('0x21')](_0x4e5017)[_0x315a('0x19')]()[_0x315a('0x6')]['rootName']&&(ee(_0x4e5017[_0x315a('0x44')](':')[0x2],_0x406a1c[_0x315a('0x3e')](),_0x11f354,_0x5ca344),_0x406a1c[_0x315a('0x49')]());_0x332f91[_0x315a('0x52')]();});});}(_0x11ef04);}[_0x315a('0x11')](){const _0x50e4a9=this[_0x315a('0x22')],_0x186a94=_0x50e4a9[_0x315a('0x1d')]['get'](_0x315a('0x4b'));_0x186a94&&_0x50e4a9[_0x315a('0x2b')]['on']('applyOperation',(_0x2a05d1,_0xd7aad6)=>{const _0x2e00cb=_0xd7aad6[0x0];if('marker'!=_0x2e00cb['type']||!_0x2e00cb[_0x315a('0x24')][_0x315a('0x41')](_0x315a('0x4d')))return;const _0x3bbf8b=_0x2e00cb[_0x315a('0x58')];_0x186a94['_createdBatches']['has'](_0x3bbf8b)&&(_0x2e00cb[_0x315a('0x55')]=_0x2e00cb['oldRange']?_0x50e4a9['model'][_0x315a('0x1f')](_0x2e00cb['oldRange']['start'],_0x2e00cb[_0x315a('0xd')][_0x315a('0x1')]):null);},{'priority':_0x315a('0x32')});}['createUserMarkerOperations'](){const _0x3496c3=this[_0x315a('0x22')],_0xb69943=_0x3496c3[_0x315a('0x2b')][_0x315a('0xf')],_0x3821fb=_0x3496c3['plugins'][_0x315a('0x21')](_0x175c00);_0x3496c3[_0x315a('0x2b')][_0x315a('0x20')]({'isUndoable':!0x1},_0x3546bf=>{const _0xb4a3d0=_0x315a('0x1a')+_0x3821fb[_0x315a('0x3')],_0x495a0c=_0x315a('0x1b')+_0x3821fb[_0x315a('0x3')],_0x597bb3=_0x3496c3[_0x315a('0x2b')]['markers']['has'](_0xb4a3d0);_0x3496c3[_0x315a('0x13')][_0x315a('0x12')]['hasDomSelection']?ee(_0x3821fb[_0x315a('0x3')],_0xb69943[_0x315a('0x1e')][_0x315a('0xe')](),_0x3496c3[_0x315a('0x2b')],_0x3546bf):_0x597bb3&&(_0x3546bf[_0x315a('0x54')](_0xb4a3d0),_0x3546bf[_0x315a('0x54')](_0x495a0c));});}}function ee(_0x3d53c6,_0x5b1cd1,_0x199eca,_0x381416){const _0x8a9b7=_0x315a('0x1a')+_0x3d53c6,_0x63d9a6=_0x315a('0x1b')+_0x3d53c6,_0x331792=_0x5b1cd1[_0x315a('0x38')]();let _0x14f5b0=_0x5b1cd1['start'];_0x331792&&_0x331792['is']('element',_0x315a('0x31'))&&(_0x14f5b0=function(_0x296526,_0x28a2c9){for(const _0x2c9ce3 of _0x296526[_0x315a('0x8')]())if(_0x28a2c9[_0x315a('0x25')][_0x315a('0x3c')](_0x2c9ce3,'$text'))return _0x2c9ce3;}(_0x5b1cd1,_0x199eca),_0x5b1cd1=_0x381416[_0x315a('0x1f')](_0x14f5b0)),_0x14f5b0=_0x381416[_0x315a('0x1f')](_0x14f5b0),_0x199eca[_0x315a('0x3a')][_0x315a('0x42')](_0x8a9b7)?(_0x381416[_0x315a('0x0')](_0x8a9b7,{'range':_0x5b1cd1}),_0x381416[_0x315a('0x0')](_0x63d9a6,{'range':_0x14f5b0})):(_0x381416[_0x315a('0x5')](_0x8a9b7,{'range':_0x5b1cd1,'usingOperation':!0x0}),_0x381416['addMarker'](_0x63d9a6,{'range':_0x14f5b0,'usingOperation':!0x0}));}