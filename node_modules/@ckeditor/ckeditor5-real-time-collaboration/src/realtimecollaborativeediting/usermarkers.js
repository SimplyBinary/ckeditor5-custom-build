/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3927=['checkChild','getPositions','getNearestSelectionRange','get','$graveyard','toDomElement','user:range','mySessionId','innerHTML','size','schema','user:range:','conversion','enqueueChange','getFirstRange','isSimilar','change:range','toRange','markerRange','getAttribute','user:position','fromRange','isInline','priority','name','model','reconvertMarker','rootName','pluginName','oldRange','createUserMarkerOperations','markerName','color','requires','applyOperation','_createdBatches','for','detach','end','getUserBySessionId','span','editingDowncast','batch','startsWith','getStart','userPositionMarker','undo','split','render','contenteditable','removeMarker','start','markers','hasContent','isObject','getSelectionClass','document','getContainedElement','getCustomProperty','setCustomProperty','parent','element','marker','createRange','set','delete','&#8203;<span\x20class=\x22ck-user__marker-line\x22><span\x20class=\x22ck-user__marker-dot\x22></span></span>','addMarker','deletionPosition','plugins','createUIElement','orderNumber','type','getMarkerClass','isLimit','editor','root','updateMarker','editing','data-session-id','getRange','UserMarkers','clear','selection','update:user:range','markerToElement','user:position:'];(function(_0x34d108,_0x39273f){const _0x2ea1ff=function(_0x101396){while(--_0x101396){_0x34d108['push'](_0x34d108['shift']());}};_0x2ea1ff(++_0x39273f);}(_0x3927,0x142));const _0x2ea1=function(_0x34d108,_0x39273f){_0x34d108=_0x34d108-0x0;let _0x2ea1ff=_0x3927[_0x34d108];return _0x2ea1ff;};import{Plugin as _0x1e8d5c}from'ckeditor5/src/core';import _0xa67681 from'./sessions';import{LiveRange as _0x1b970f}from'ckeditor5/src/engine';import'../../theme/usermarkers.css';export default class P extends _0x1e8d5c{static get[_0x2ea1('0x3b')](){return[_0xa67681];}static get[_0x2ea1('0x36')](){return _0x2ea1('0x14');}['init'](){const _0xf386f9=this['editor'],_0x3a6e94=_0xf386f9[_0x2ea1('0x8')][_0x2ea1('0x1d')](_0xa67681);_0xf386f9[_0x2ea1('0x26')][_0x2ea1('0x3e')]('editingDowncast')[_0x2ea1('0x18')]({'model':_0x2ea1('0x2e'),'view':(_0x4dc18f,{writer:_0x1a760e})=>function(_0x7acdc1,_0x3bcb8a,_0x2ea360,_0x51be86){const _0x5a358d=_0x7acdc1[_0x2ea1('0x39')][_0x2ea1('0x49')](':')[0x2],_0x50fa88=_0x2ea360[_0x2ea1('0x41')](_0x5a358d);if(!_0x50fa88||_0x5a358d===_0x2ea360['mySessionId'])return;if(!_0x51be86[_0x2ea1('0x33')][_0x2ea1('0x24')]['checkChild'](_0x7acdc1[_0x2ea1('0x2c')]['start'],'$text'))return;const _0x5b2faf={'class':'ck-user__marker\x20'+_0x50fa88['color'][_0x2ea1('0xc')](),'data-name':_0x50fa88[_0x2ea1('0x32')],'data-session-id':_0x5a358d},_0x2c24d2=_0x51be86[_0x2ea1('0x33')]['markers']['get'](_0x7acdc1[_0x2ea1('0x39')])[_0x2ea1('0x46')](),_0x3c79cf=_0x2c24d2['nodeAfter'],_0x3ccc02=_0x51be86[_0x2ea1('0x33')]['schema'];if(_0x3c79cf&&_0x3ccc02[_0x2ea1('0x50')](_0x3c79cf)&&_0x3ccc02[_0x2ea1('0x30')](_0x3c79cf)&&!_0x51be86[_0x2ea1('0x33')][_0x2ea1('0x4e')]['get'](_0x2ea1('0x25')+_0x5a358d)[_0x2ea1('0x13')]()['isCollapsed'])return;const _0x5cd92e=_0x2c24d2[_0x2ea1('0x56')];_0x51be86['model'][_0x2ea1('0x24')][_0x2ea1('0xd')](_0x5cd92e)&&!_0x51be86[_0x2ea1('0x33')][_0x2ea1('0x4f')](_0x5cd92e)&&(_0x5b2faf[_0x2ea1('0x4b')]=!0x1);const _0x337423=function(_0xdd8ab2,_0x42a493){const _0x456a2b=_0xdd8ab2[_0x2ea1('0x9')](_0x2ea1('0x42'),_0x42a493);return _0xdd8ab2[_0x2ea1('0x55')]('userPositionMarker',!0x0,_0x456a2b),_0x456a2b[_0x2ea1('0x4a')]=function(_0x37e38f){const _0x4056b9=this[_0x2ea1('0x1f')](_0x37e38f);return _0x4056b9[_0x2ea1('0x22')]=_0x2ea1('0x5'),_0x4056b9;},_0x456a2b[_0x2ea1('0x29')]=function(_0x3f1693){return this[_0x2ea1('0x54')](_0x2ea1('0x47'))&&_0x3f1693[_0x2ea1('0x54')](_0x2ea1('0x47'))&&this[_0x2ea1('0x2d')](_0x2ea1('0x12'))==_0x3f1693[_0x2ea1('0x2d')]('data-session-id');},_0x456a2b;}(_0x3bcb8a,_0x5b2faf);return _0x337423[_0x2ea1('0x31')]=0x3e8+_0x50fa88[_0x2ea1('0xa')],_0x337423;}(_0x4dc18f,_0x1a760e,_0x3a6e94,_0xf386f9)}),_0xf386f9[_0x2ea1('0x26')][_0x2ea1('0x3e')](_0x2ea1('0x43'))['markerToHighlight']({'model':_0x2ea1('0x20'),'view':_0x236e39=>function(_0x5e957b,_0x612d2e){const _0x1ab010=_0x5e957b[_0x2ea1('0x39')]['split'](':')[0x2];if(_0x1ab010===_0x612d2e[_0x2ea1('0x21')])return;const _0x25b24d=_0x612d2e[_0x2ea1('0x41')](_0x1ab010);if(!_0x25b24d)return{'id':_0x1ab010};return{'id':_0x1ab010,'classes':['ck-user__selection',_0x25b24d[_0x2ea1('0x3a')][_0x2ea1('0x51')]()],'attributes':{'data-session-id':_0x1ab010},'priority':0x7d0+_0x25b24d[_0x2ea1('0xa')]};}(_0x236e39,_0x3a6e94)}),function(_0xce59ac){const _0x5710a5=_0xce59ac[_0x2ea1('0x33')],_0xe9dc08=new Map(),_0x4487bd=_0xce59ac[_0x2ea1('0x8')][_0x2ea1('0x1d')](_0xa67681);_0x5710a5[_0x2ea1('0x4e')]['on'](_0x2ea1('0x17'),(_0x1aae1b,_0x5ecdf8,_0x57355a,_0xc3c51f)=>{if(!_0xc3c51f&&_0xe9dc08[_0x2ea1('0x1d')](_0x5ecdf8[_0x2ea1('0x32')]))return _0xe9dc08[_0x2ea1('0x1d')](_0x5ecdf8[_0x2ea1('0x32')])[_0x2ea1('0x3f')](),void _0xe9dc08[_0x2ea1('0x4')](_0x5ecdf8[_0x2ea1('0x32')]);const _0x31d139=_0x5ecdf8[_0x2ea1('0x32')][_0x2ea1('0x49')](':')[0x2];if(_0x31d139===_0x4487bd['mySessionId'])return;const _0xb541a=_0x2ea1('0x19')+_0x31d139;_0x5710a5[_0x2ea1('0x4e')]['has'](_0xb541a)&&_0xce59ac[_0x2ea1('0x11')][_0x2ea1('0x34')](_0xb541a),_0x5ecdf8['on'](_0x2ea1('0x2a'),(_0x1b7c99,_0x1e8389,_0x4f39bc)=>{if(_0x2ea1('0x1e')!=_0x1e8389['root']['rootName']&&_0x2ea1('0x1e')==_0x5ecdf8['getRange']()[_0x2ea1('0xf')][_0x2ea1('0x35')]&&!_0xe9dc08['has'](_0x5ecdf8['name'])){const _0x4c5c77=_0x5710a5[_0x2ea1('0x24')][_0x2ea1('0x1c')](_0x4f39bc[_0x2ea1('0x7')]);if(_0x4c5c77){const _0x20f8ca=_0x1b970f[_0x2ea1('0x2f')](_0x4c5c77);_0xe9dc08[_0x2ea1('0x3')](_0x5ecdf8[_0x2ea1('0x32')],_0x20f8ca),_0x20f8ca['on'](_0x2ea1('0x2a'),(_0x3a050f,_0x332e2e,_0x4f6857)=>{if(_0x2ea1('0x1e')==_0x20f8ca[_0x2ea1('0xf')][_0x2ea1('0x35')]){const _0x57b5ca=_0x5710a5['schema'][_0x2ea1('0x1c')](_0x4f6857[_0x2ea1('0x7')]);_0x57b5ca?(_0x20f8ca[_0x2ea1('0x4d')]=_0x57b5ca[_0x2ea1('0x4d')],_0x20f8ca[_0x2ea1('0x40')]=_0x57b5ca[_0x2ea1('0x40')]):(_0xe9dc08['delete'](_0x5ecdf8[_0x2ea1('0x32')]),_0x20f8ca[_0x2ea1('0x3f')]());}});}}});}),_0x5710a5[_0x2ea1('0x52')]['on']('change',()=>{_0xe9dc08[_0x2ea1('0x23')]>0x0&&_0x5710a5[_0x2ea1('0x27')]({'isUndoable':!0x1},_0x25f6f2=>{for(const [_0x28ffb1,_0x426320]of _0xe9dc08)'$graveyard'==_0x5710a5['markers'][_0x2ea1('0x1d')](_0x28ffb1)['getRange']()[_0x2ea1('0xf')][_0x2ea1('0x35')]&&(q(_0x28ffb1[_0x2ea1('0x49')](':')[0x2],_0x426320[_0x2ea1('0x2b')](),_0x5710a5,_0x25f6f2),_0x426320['detach']());_0xe9dc08[_0x2ea1('0x15')]();});});}(_0xf386f9);}['afterInit'](){const _0x57dcd9=this[_0x2ea1('0xe')],_0x1d5f0a=_0x57dcd9['commands']['get'](_0x2ea1('0x48'));_0x1d5f0a&&_0x57dcd9[_0x2ea1('0x33')]['on'](_0x2ea1('0x3c'),(_0x411296,_0x14993c)=>{const _0x20b835=_0x14993c[0x0];if(_0x2ea1('0x1')!=_0x20b835[_0x2ea1('0xb')]||!_0x20b835[_0x2ea1('0x32')][_0x2ea1('0x45')]('user:'))return;const _0x20215a=_0x20b835[_0x2ea1('0x44')];_0x1d5f0a[_0x2ea1('0x3d')]['has'](_0x20215a)&&(_0x20b835['newRange']=_0x20b835['oldRange']?_0x57dcd9[_0x2ea1('0x33')][_0x2ea1('0x2')](_0x20b835[_0x2ea1('0x37')]['start'],_0x20b835[_0x2ea1('0x37')][_0x2ea1('0x40')]):null);},{'priority':'highest'});}[_0x2ea1('0x38')](){const _0x57c5c6=this['editor'],_0x195e8d=_0x57c5c6[_0x2ea1('0x33')][_0x2ea1('0x52')],_0x53b445=_0x57c5c6[_0x2ea1('0x8')][_0x2ea1('0x1d')](_0xa67681);_0x57c5c6[_0x2ea1('0x33')][_0x2ea1('0x27')]({'isUndoable':!0x1},_0x49f014=>{const _0x558046=_0x2ea1('0x25')+_0x53b445[_0x2ea1('0x21')],_0x8a7b88=_0x2ea1('0x19')+_0x53b445[_0x2ea1('0x21')],_0x5f593d=_0x57c5c6['model']['markers']['has'](_0x558046);_0x57c5c6[_0x2ea1('0x11')]['view']['hasDomSelection']?q(_0x53b445[_0x2ea1('0x21')],_0x195e8d[_0x2ea1('0x16')][_0x2ea1('0x28')](),_0x57c5c6[_0x2ea1('0x33')],_0x49f014):_0x5f593d&&(_0x49f014['removeMarker'](_0x558046),_0x49f014[_0x2ea1('0x4c')](_0x8a7b88));});}}function q(_0x365155,_0xb15b8f,_0x5d430c,_0xbe3780){const _0x2693d4=_0x2ea1('0x25')+_0x365155,_0x58e61c=_0x2ea1('0x19')+_0x365155,_0x566b65=_0xb15b8f[_0x2ea1('0x53')]();let _0x29068e=_0xb15b8f[_0x2ea1('0x4d')];_0x566b65&&_0x566b65['is'](_0x2ea1('0x0'),'tableCell')&&(_0x29068e=function(_0x86b8e9,_0x9c192d){for(const _0x595124 of _0x86b8e9[_0x2ea1('0x1b')]())if(_0x9c192d[_0x2ea1('0x24')][_0x2ea1('0x1a')](_0x595124,'$text'))return _0x595124;}(_0xb15b8f,_0x5d430c),_0xb15b8f=_0xbe3780['createRange'](_0x29068e)),_0x29068e=_0xbe3780[_0x2ea1('0x2')](_0x29068e),_0x5d430c[_0x2ea1('0x4e')]['has'](_0x2693d4)?(_0xbe3780[_0x2ea1('0x10')](_0x2693d4,{'range':_0xb15b8f}),_0xbe3780[_0x2ea1('0x10')](_0x58e61c,{'range':_0x29068e})):(_0xbe3780['addMarker'](_0x2693d4,{'range':_0xb15b8f,'usingOperation':!0x0}),_0xbe3780[_0x2ea1('0x6')](_0x58e61c,{'range':_0x29068e,'usingOperation':!0x0}));}