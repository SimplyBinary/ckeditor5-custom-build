/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
'use strict';var __importDefault=this&&this['__importDefault']||function(_0x6239be){return _0x6239be&&_0x6239be['__esModule']?_0x6239be:{'default':_0x6239be};};Object['defineProperty'](exports,'__esModule',{'value':!0x0});const ckeditorcloudserviceserror_1=__importDefault(require('../ckeditorcloudserviceserror'));class WebSocketRequest{constructor(_0x4011ac,_0xde4340){this['_context']=_0x4011ac,this['_deferredPromise']=function(){let _0x2e7dc0,_0x40a427;const _0x4cf613=new Promise((_0xf1aa68,_0x239bcf)=>{_0x2e7dc0=_0xf1aa68,_0x40a427=_0x239bcf;});return{'resolve':_0x2e7dc0,'reject':_0x40a427,'promise':_0x4cf613};}(),this['timeout']=setTimeout(()=>this['error'](new ckeditorcloudserviceserror_1['default']('Request\x20timeout.',this['_context'])),_0xde4340);}get['promise'](){return this['_deferredPromise']['promise'];}['response'](_0x4cd4ad){this['_deferredPromise']['resolve'](_0x4cd4ad);}['error'](_0x32732c){this['_deferredPromise']['reject'](_0x32732c);}}exports['default']=class{constructor(_0x340f3a){this['_context']=_0x340f3a,this['_requests']=new Set();}async['send'](_0x16e06e,_0x771269=0x2710){const _0x3c9293=this['_createRequest'](_0x771269);try{return _0x16e06e(_0x3c9293),await _0x3c9293['promise'];}finally{this['_finishRequest'](_0x3c9293);}}['errorAll'](_0x433597){for(const _0x2cb8d6 of this['_requests'])_0x2cb8d6['error'](_0x433597);}['_createRequest'](_0x591262){const _0x363bdd=new WebSocketRequest(this['_context'],_0x591262);return this['_requests']['add'](_0x363bdd),_0x363bdd;}['_finishRequest'](_0x3a2985){this['_requests']['delete'](_0x3a2985),clearTimeout(_0x3a2985['timeout']);}};