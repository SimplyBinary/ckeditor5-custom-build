/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4aa333){return _0x4aa333&&_0x4aa333['__esModule']?_0x4aa333:{'default':_0x4aa333};};Object['defineProperty'](exports,'__esModule',{'value':!0x0});const ckeditorcloudserviceserror_1=__importDefault(require('../ckeditorcloudserviceserror'));class WebSocketRequest{constructor(_0x32ebdc,_0x2f5439){this['_context']=_0x32ebdc,this['_deferredPromise']=function(){let _0xf522bd,_0x5e43f7;const _0x72de4d=new Promise((_0x175f07,_0x4dda0d)=>{_0xf522bd=_0x175f07,_0x5e43f7=_0x4dda0d;});return{'resolve':_0xf522bd,'reject':_0x5e43f7,'promise':_0x72de4d};}(),this['timeout']=setTimeout(()=>this['error'](new ckeditorcloudserviceserror_1['default']('Request\x20timeout.',this['_context'])),_0x2f5439);}get['promise'](){return this['_deferredPromise']['promise'];}['response'](_0x334587){this['_deferredPromise']['resolve'](_0x334587);}['error'](_0x32f70b){this['_deferredPromise']['reject'](_0x32f70b);}}exports['default']=class{constructor(_0x5a8678){this['_context']=_0x5a8678,this['_requests']=new Set();}async['send'](_0x3f8ee4,_0xa25f21=0x2710){const _0x2de52b=this['_createRequest'](_0xa25f21);try{return _0x3f8ee4(_0x2de52b),await _0x2de52b['promise'];}finally{this['_finishRequest'](_0x2de52b);}}['errorAll'](_0x57111d){for(const _0x158a25 of this['_requests'])_0x158a25['error'](_0x57111d);}['_createRequest'](_0x19b74c){const _0x161545=new WebSocketRequest(this['_context'],_0x19b74c);return this['_requests']['add'](_0x161545),_0x161545;}['_finishRequest'](_0x24b77b){this['_requests']['delete'](_0x24b77b),clearTimeout(_0x24b77b['timeout']);}};