/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x332a=['_getNextColor','initials','toUpperCase','users.colorsCount','getMarkerClass','name','split','destroy','get','_lastColor','has','_myId','_id','users-me-already-defined','users.anonymousUserId','users-add-invalid-id','trial-license-key-reached-limit','define','users-add-duplicated-id','anonymous-user','Anonymous','ck-user__selection--','isAnonymous','_licenseKeyCheckInterval','_addAnonymousUser','licenseKeyValid','decorate','licenseKey','getSelectionClass','Users','context','string','ck-user__marker--','addUser','_getInitial','getUser','length','invalid-license-key','licenseKeyInvalid','config','init','ck-user__bg-color--','licenseKeyTrialLimit','defineMe','color','getOperationAuthor','licenseKeyTrial','trim','assign','_isAnonymous','_locale','requires','avatar','users'];(function(_0x5174cd,_0x332a86){const _0x57b80c=function(_0x1747ef){while(--_0x1747ef){_0x5174cd['push'](_0x5174cd['shift']());}};_0x57b80c(++_0x332a86);}(_0x332a,0x1ba));const _0x57b8=function(_0x5174cd,_0x332a86){_0x5174cd=_0x5174cd-0x0;let _0x57b80c=_0x332a[_0x5174cd];return _0x57b80c;};import{ContextPlugin as _0x422e81}from'ckeditor5/src/core';import{Collection as _0x2f5c5a,CKEditorError as _0x4f5723}from'ckeditor5/src/utils';import _0x4b147b from'./permissions';import{getTranslation as _0x337e60}from'./utils/common-translations';import'../theme/usercolors.css';export default class l extends _0x422e81{static get['pluginName'](){return _0x57b8('0x13');}static get[_0x57b8('0x29')](){return[_0x4b147b];}constructor(_0x4b74bf){super(_0x4b74bf),_0x4b74bf[_0x57b8('0x1d')][_0x57b8('0x7')](_0x57b8('0x4'),_0x57b8('0x9')),_0x4b74bf[_0x57b8('0x1d')][_0x57b8('0x7')](_0x57b8('0x2f'),0x8),this[_0x57b8('0x2b')]=new _0x2f5c5a(),this[_0x57b8('0x28')]=_0x4b74bf['locale'],this[_0x57b8('0xd')]=null,this['_lastColor']=0x0,this['_myId']=null,this[_0x57b8('0x10')](_0x57b8('0x23'));}[_0x57b8('0x1e')](){const _0x414172=this['context'];this[_0x57b8('0x11')]=_0x414172['config'][_0x57b8('0x34')](_0x57b8('0x11')),this[_0x57b8('0xd')]=setInterval(()=>{let _0x30d2de;for(const _0x489255 in _0x414172){const _0x39ff46=_0x414172[_0x489255];if(_0x57b8('0x24')===_0x39ff46||_0x57b8('0x1c')===_0x39ff46||_0x57b8('0xf')===_0x39ff46||'licenseKeyTrialLimit'==_0x39ff46){delete _0x414172[_0x489255],_0x30d2de=_0x39ff46;break;}}if(_0x57b8('0x1c')===_0x30d2de)throw clearInterval(this[_0x57b8('0xd')]),new _0x4f5723(_0x57b8('0x1b'),null);if(_0x57b8('0x24')===_0x30d2de&&console['info']('You\x20are\x20using\x20the\x20trial\x20version\x20of\x20CKEditor\x205\x20collaboration\x20plugin\x20with\x20limited\x20usage.\x20Make\x20sure\x20you\x20will\x20not\x20use\x20it\x20in\x20the\x20production\x20environment.'),_0x57b8('0x20')===_0x30d2de)throw clearInterval(this[_0x57b8('0xd')]),new _0x4f5723(_0x57b8('0x6'),null);_0x57b8('0xf')===_0x30d2de&&clearInterval(this[_0x57b8('0xd')]);},0x3e8),this['_addAnonymousUser']();}get['me'](){return null==this[_0x57b8('0x1')]?null:this[_0x57b8('0x19')](this[_0x57b8('0x1')]);}[_0x57b8('0x17')](_0x4b7381){if(!(_0x4b7381=Object[_0x57b8('0x26')]({},_0x4b7381,{'color':this['_getNextColor']()}))['id']||_0x57b8('0x15')!=typeof _0x4b7381['id'])throw new _0x4f5723(_0x57b8('0x5'));if(this['users'][_0x57b8('0x0')](_0x4b7381['id']))throw new _0x4f5723(_0x57b8('0x8'),null,{'id':_0x4b7381['id']});_0x4b7381[_0x57b8('0x31')]=function(_0x10c5ee,_0x2ef016=''){return''==(_0x2ef016=_0x2ef016[_0x57b8('0x25')]())?_0x337e60(_0x10c5ee,'Anonymous'):_0x2ef016;}(this['_locale'],_0x4b7381[_0x57b8('0x31')]);const _0x4066d3=new u(_0x4b7381);return this['users']['add'](_0x4066d3),_0x4066d3;}[_0x57b8('0x19')](_0x32a8db){return this[_0x57b8('0x2b')][_0x57b8('0x34')](_0x32a8db);}['useAnonymousUser'](){const _0x4fae3b=this[_0x57b8('0x14')]['config'][_0x57b8('0x34')]('users.anonymousUserId');this[_0x57b8('0x1')]||this[_0x57b8('0x21')](_0x4fae3b);}['defineMe'](_0x4506a5){if(this[_0x57b8('0x1')])throw new _0x4f5723(_0x57b8('0x3'),null);if(!this['getUser'](_0x4506a5))throw new _0x4f5723('users-me-missing-user',null);this[_0x57b8('0x1')]=_0x4506a5;}['getOperationAuthor'](){return this['me'];}['destroy'](){super[_0x57b8('0x33')](),clearInterval(this[_0x57b8('0xd')]);}[_0x57b8('0x2c')](){const _0xf97efb=this[_0x57b8('0x14')][_0x57b8('0x1d')][_0x57b8('0x34')]('users.colorsCount');return this[_0x57b8('0x35')]>=_0xf97efb&&(this['_lastColor']=0x0),new h(this[_0x57b8('0x35')]++);}[_0x57b8('0xe')](){const _0x3f3d14=this['context'][_0x57b8('0x1d')]['get'](_0x57b8('0x4'));this[_0x57b8('0x17')]({'id':_0x3f3d14,'name':_0x337e60(this[_0x57b8('0x28')],_0x57b8('0xa'))})[_0x57b8('0x27')]=!0x0;}}class u{constructor(_0x460e9e){this['id']=_0x460e9e['id'],this[_0x57b8('0x22')]=_0x460e9e[_0x57b8('0x22')],this['name']=_0x460e9e[_0x57b8('0x31')],this['avatar']=_0x460e9e[_0x57b8('0x2a')],this[_0x57b8('0x27')]=!0x1;}get[_0x57b8('0xc')](){return this['_isAnonymous'];}get[_0x57b8('0x2d')](){const _0x373eff=this[_0x57b8('0x31')][_0x57b8('0x32')]('\x20');return 0x1===_0x373eff[_0x57b8('0x1a')]?this[_0x57b8('0x18')](_0x373eff[0x0]):this['_getInitial'](_0x373eff[0x0])+this[_0x57b8('0x18')](_0x373eff[_0x373eff[_0x57b8('0x1a')]-0x1]);}[_0x57b8('0x18')](_0x478447){return _0x478447['charAt'](0x0)[_0x57b8('0x2e')]();}}class h{constructor(_0x4953e1){this['_id']=_0x4953e1;}['getBackgroundColorClass'](){return _0x57b8('0x1f')+this[_0x57b8('0x2')];}[_0x57b8('0x12')](){return _0x57b8('0xb')+this[_0x57b8('0x2')];}[_0x57b8('0x30')](){return _0x57b8('0x16')+this[_0x57b8('0x2')];}}